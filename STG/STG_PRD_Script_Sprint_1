-- DDL for Table ISTCARD

DROP TABLE STG_PRD_DB.ISTCARD;
 CREATE TABLE STG_PRD_DB.ISTCARD 
 ( 
 PAN 			    STRING, 
 BASE			    STRING, 
 REGION 		    STRING, 
 BRANCH 		    STRING, 
 MISID 			    STRING, 
 GROUPCODE 		    STRING, 
 CARDTYPE 		    STRING, 
 STATUS 		    INT, 
 EXPIRYDATE 		    DATE, 
 PRIMARYACCT 		    STRING, 
 PRIMARYACCTTYPE 	    STRING, 
 SECONDARYACCT 		    STRING, 
 SECONDARYACCTTYPE 	    STRING, 
 RELATIONINDICATOR 	    STRING, 
 LIMITINDICATOR 	    STRING, 
 LANGUAGECODE 		    STRING, 
 TXNCODE		    STRING, 
 LAST_ACTIVITY_DATE 	    DATE, 
 LAST_ACTIVITY_TIME 	    INT, 
 PKVI 			    STRING, 
 PVV 			    STRING, 
 CASH_WD_AMT_USED 	    DOUBLE, 
 CASH_WD_COUNT 		    INT, 
 CASH_WD_DATE 		    DATE, 
 CASH_WD_TIME 		    INT, 
 TC_WD_AMT_USED 	    DOUBLE, 
 TC_WD_COUNT 		    INT, 
 TC_WD_DATE 		    DATE, 
 TC_WD_TIME 		    INT, 
 CASH_TC_AMT_USED	    DOUBLE, 
 CASH_TC_DATE 		    DATE, 
 CASH_TC_TIME 		    INT, 
 PURCH_AMT_USED 	    DOUBLE, 
 PURCH_COUNT 		    INT, 
 PURCH_DATE 		    DATE, 
 PURCH_TIME 		    INT, 
 TSF_BASE_CUR_USED 	    DOUBLE, 
 TSF_BASE_CUR_DATE 	    DATE, 
 TSF_BASE_CUR_TIME 	    INT, 
 TSF_MULTI_CUR_USED 	    DOUBLE, 
 TSF_MULTI_CUR_DATE 	    DATE, 
 TSF_MULTI_CUR_TIME 	    INT, 
 PINRETRY 		    INT, 
 BLOCKCODE 		    STRING, 
 ALTBLOCKCODE 		    STRING, 
 CREDIT_LIMIT 		    DOUBLE, 
 CREDIT_LIMIT_USED 	    DOUBLE, 
 CASH_ADVANCE_LIMIT 	    DOUBLE, 
 CASH_ADVANCE_USED 	    DOUBLE, 
 DECLINE_COUNT 		    INT, 
 DECLINE_DATE 		    DATE, 
 DECLINE_TIME 		    INT, 
 TEMP_PKVI 		    STRING, 
 TEMP_PVV 		    STRING, 
 TPKVI 			    STRING, 
 TPVV 			    STRING, 
 TPINRETRY 		    INT, 
 TEMP_TPKVI 		    STRING, 
 TEMP_TPVV 		    STRING, 
 CONSENT_DATE 		    DATE, 
 SEQ_NO 		    INT, 
 OLD_EXP_DATE 		    DATE, 
 CASH_DEP_USED 		    DOUBLE, 
 CASH_DEP_DATE 		    DATE, 
 PINOFFSET 		    STRING, 
 TEMP_PINOFFSET 	    STRING, 
 TPINOFFSET 		    STRING, 
 TEMP_TPINOFFSET 	    STRING, 
 BIN 			    STRING, 
 MASK_PAN 		    STRING, 
 EMV_FLAG 		    STRING, 
 KYC 			    STRING, 
 ROWHASH 		    STRING, 
 LD_DATE 		    INT, 
 LAST_UPD_DATE 		    INT
 )
CLUSTERED BY (PAN , MISID,BRANCH,BIN) INTO 32 BUCKETS
STORED AS ORC
TBLPROPERTIES ('transactional'='true', "orc.compress"="SNAPPY");


-- DDL for Table ISTCARDTYPE_DESC

DROP TABLE STG_PRD_DB.ISTCARDTYPE_DESC;
CREATE TABLE STG_PRD_DB.ISTCARDTYPE_DESC 
( CARDTYPE 		STRING, 
 E_DESC 		STRING,
 PROVIDER 		STRING,
 ROWHASH 		STRING, 
 LD_DATE 		INT, 
 LAST_UPD_DATE 		INT
 )
CLUSTERED BY (CARDTYPE) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES ('transactional'='true', "orc.compress"="SNAPPY");



