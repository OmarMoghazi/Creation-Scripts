/* DDL for Table H_CORPORATE_DETAIL */

ALTER TABLE DWH_TST_DB.H_CORPORATE_DETAIL RENAME TO DWH_TST_DB.H_CORPORATE_DETAIL_SP1;

CREATE TABLE DWH_TST_DB.H_CORPORATE_DETAIL (
    CORPORATE_DETAIL_ID       INT,
    CUST_ID                   INT,
    DWH_ID		      INT,
    CIF			      STRING,
    AMT_NET_WORTH_COMP        DOUBLE,
    AMT_AUTH_CAPITAL          DOUBLE,
    AMT_PAIDUP_CAPITAL        DOUBLE,
    AMT_RESERV_LST_YR         DOUBLE,
    AMT_NET_PROF_LOSS_LST_YR  DOUBLE,
    NAM_PLACE_INCORP          STRING,
    TYP_COMPANY               STRING,
    LAST_FIN_INFO_UPDAT_DT    INT,
    CTR_PARTNERS_DIRECTORS    INT,
    NAME_MAJ_SHAREHLDR1       STRING,
    NAME_MAJ_SHAREHLDR2       STRING,
    NAME_MAJ_SHAREHLDR3       STRING,
    NAME_MAJ_SHAREHLDR4       STRING,
    NAME_MAJ_SHAREHLDR5       STRING,
    NAME_MAJ_SHAREHLDR6       STRING,
    NAME_MAJ_SHAREHLDR7       STRING,
    NAME_MAJ_SHAREHLDR8       STRING,
    NAME_MAJ_SHAREHLDR9       STRING,
    NAME_MAJ_SHAREHLDR10      STRING,
    COD_MAJ_SHAREHLDR_REL1    STRING,
    COD_MAJ_SHAREHLDR_REL2    STRING,
    COD_MAJ_SHAREHLDR_REL3    STRING,
    COD_MAJ_SHAREHLDR_REL4    STRING,
    COD_MAJ_SHAREHLDR_REL5    STRING,
    COD_MAJ_SHAREHLDR_REL6    STRING,
    COD_MAJ_SHAREHLDR_REL7    STRING,
    COD_MAJ_SHAREHLDR_REL8    STRING,
    COD_MAJ_SHAREHLDR_REL9    STRING,
    COD_MAJ_SHAREHLDR_REL10   STRING,
    COD_BUSINESS_LICENSE      STRING,
    DT_BUS_START              INT,
    DT_BUS_LICENSE_EXP        INT,
    NAM_CONTACT_PERSON        STRING,
    TXT_DESGN_CONTACT_PERSN   STRING,
    NAM_PARENT_COMPANY        STRING,
    TXT_INT_CR_RATING         STRING,
    TXT_BUSINESS_TYP          STRING,
    MAKER_ID                  STRING,
    CHECKER_ID                STRING,
    LAST_MNT_DT               INT,
    ROWHASH			     	  STRING,
    BUSINESS_DT               INT 
)CLUSTERED BY (CIF,DWH_ID) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.H_CORPORATE_DETAIL
(
    CORPORATE_DETAIL_ID       ,
    CUST_ID                   ,
    DWH_ID		      ,
    CIF			      ,
    AMT_NET_WORTH_COMP        ,
    AMT_AUTH_CAPITAL          ,
    AMT_PAIDUP_CAPITAL        ,
    AMT_RESERV_LST_YR         ,
    AMT_NET_PROF_LOSS_LST_YR  ,
    NAM_PLACE_INCORP          ,
    TYP_COMPANY               ,
    LAST_FIN_INFO_UPDAT_DT    ,
    CTR_PARTNERS_DIRECTORS    ,
    NAME_MAJ_SHAREHLDR1       ,
    NAME_MAJ_SHAREHLDR2       ,
    NAME_MAJ_SHAREHLDR3       ,
    NAME_MAJ_SHAREHLDR4       ,
    NAME_MAJ_SHAREHLDR5       ,
    NAME_MAJ_SHAREHLDR6       ,
    NAME_MAJ_SHAREHLDR7       ,
    NAME_MAJ_SHAREHLDR8       ,
    NAME_MAJ_SHAREHLDR9       ,
    NAME_MAJ_SHAREHLDR10      ,
    COD_MAJ_SHAREHLDR_REL1    ,
    COD_MAJ_SHAREHLDR_REL2    ,
    COD_MAJ_SHAREHLDR_REL3    ,
    COD_MAJ_SHAREHLDR_REL4    ,
    COD_MAJ_SHAREHLDR_REL5    ,
    COD_MAJ_SHAREHLDR_REL6    ,
    COD_MAJ_SHAREHLDR_REL7    ,
    COD_MAJ_SHAREHLDR_REL8    ,
    COD_MAJ_SHAREHLDR_REL9    ,
    COD_MAJ_SHAREHLDR_REL10   ,
    COD_BUSINESS_LICENSE      ,
    DT_BUS_START              ,
    DT_BUS_LICENSE_EXP        ,
    NAM_CONTACT_PERSON        ,
    TXT_DESGN_CONTACT_PERSN   ,
    NAM_PARENT_COMPANY        ,
    TXT_INT_CR_RATING         ,
    TXT_BUSINESS_TYP          ,
    MAKER_ID                  ,
    CHECKER_ID                ,
    LAST_MNT_DT               ,
    ROWHASH		      ,
    BUSINESS_DT               
)
SELECT
    ID                        ,
    CUST_ID                   ,
    DWH_ID		      ,
    CIF			      ,
    AMT_NET_WORTH_COMP        ,
    AMT_AUTH_CAPITAL          ,
    AMT_PAIDUP_CAPITAL        ,
    AMT_RESERV_LST_YR         ,
    AMT_NET_PROF_LOSS_LST_YR  ,
    NAM_PLACE_INCORP          ,
    TYP_COMPANY               ,
    LAST_FIN_INFO_UPDAT_DT    ,
    CTR_PARTNERS_DIRECTORS    ,
    NAME_MAJ_SHAREHLDR1       ,
    NAME_MAJ_SHAREHLDR2       ,
    NAME_MAJ_SHAREHLDR3       ,
    NAME_MAJ_SHAREHLDR4       ,
    NAME_MAJ_SHAREHLDR5       ,
    NAME_MAJ_SHAREHLDR6       ,
    NAME_MAJ_SHAREHLDR7       ,
    NAME_MAJ_SHAREHLDR8       ,
    NAME_MAJ_SHAREHLDR9       ,
    NAME_MAJ_SHAREHLDR10      ,
    COD_MAJ_SHAREHLDR_REL1    ,
    COD_MAJ_SHAREHLDR_REL2    ,
    COD_MAJ_SHAREHLDR_REL3    ,
    COD_MAJ_SHAREHLDR_REL4    ,
    COD_MAJ_SHAREHLDR_REL5    ,
    COD_MAJ_SHAREHLDR_REL6    ,
    COD_MAJ_SHAREHLDR_REL7    ,
    COD_MAJ_SHAREHLDR_REL8    ,
    COD_MAJ_SHAREHLDR_REL9    ,
    COD_MAJ_SHAREHLDR_REL10   ,
    COD_BUSINESS_LICENSE      ,
    DT_BUS_START              ,
    DT_BUS_LICENSE_EXP        ,
    NAM_CONTACT_PERSON        ,
    TXT_DESGN_CONTACT_PERSN   ,
    NAM_PARENT_COMPANY        ,
    TXT_INT_CR_RATING         ,
    TXT_BUSINESS_TYP          ,
    MAKER_ID                  ,
    CHECKER_ID                ,
    LAST_MNT_DT               ,
    ROWHASH		      ,
    BUSINESS_DT               
FROM DWH_TST_DB.H_CORPORATE_DETAIL_SP1;





/* DDL for Table H_CUSTOMER */


ALTER TABLE DWH_TST_DB.H_CUSTOMER RENAME TO DWH_TST_DB.H_CUSTOMER_SP1;

CREATE TABLE DWH_TST_DB.H_CUSTOMER (
    CUST_ID                        INT,
    DWH_ID                         INT,
    CIF                            STRING,
    T24_ID			   STRING,
    CBE_REF_COD                    STRING,
    CUST_BRN_ID			   INT,
    LIAB_NO                        INT,
    OPEN_DT                        INT,
    BIRTH_DT                       INT,
    CUSTOMER_TYPE_ID               INT,
    CUST_STATUS_ID                 INT,
    NATIONAL_ID			   STRING,
    SECONDARY_IDENTITY_ID          INT,
    SECONDARY_IDENTITY_VALUE       STRING,
    CUST_TIN			   STRING,
    FULL_NAME_AR                   STRING,
    FIRST_NAME_AR                  STRING,
    MID_NAME_AR                    STRING,
    LAST_NAME_AR                   STRING,
    FULL_NAME_EN                   STRING,
    FIRST_NAME_EN                  STRING,
    MID_NAME_EN                    STRING,
    LAST_NAME_EN                   STRING,
    NATIONALITY                    STRING,
    EMAIL                          STRING,
    GENDER                         STRING,
    CUST_PREFIX                    STRING,
    LANGUAGE_ID                    INT,
    GUARDIAN_TYPE                  INT,
    SIGNATURE_ID                   INT,
    BUSINESS_TYPE_ID               INT,
    PROFESSION_ID                  INT,
    MARITAL_STATUS_ID              INT,
    CREDIT_RATING                  STRING,
    REVISION_DATE                  INT,
    ADDR1                          STRING,
    ADDR2                          STRING,
    ADDR3                          STRING,
    ZIP_COD                        STRING,
    CITY                           STRING,
    FAX                            STRING,
    PERMN_ADDR1                    STRING,
    PERMN_ADDR2                    STRING,
    PERMN_ADDR3                    STRING,
    PERMN_CITY                     STRING,
    PERMN_ZIP_COD                  STRING,
    PERMN_GOV_ID                   INT,
    PERMN_COUNTRY_ID               INT,
    PHONE_NUM_1                    STRING,
    PHONE_NUM_2                    STRING,
    PHONE_NUM_3 /*TELEX*/	   STRING,
    CC_MOB_NUM                     STRING,
    WALLET_MOB_NUM                 STRING,
    IB_MOB_NUM                     STRING,
    PPC_MOB_NUM                    STRING,
    DC_MOB_NUM                     STRING,
    IB_EMAIL                       STRING,
    CUST_OCCUPATION                STRING,
    CUST_DESIGNATION               STRING,
    CUST_SALARY                    DOUBLE,
    SPOUSE_NAME_AR                 STRING,
    SPOUSE_NAME_EN                 STRING,
    MARRIAGE_DT                    INT,
    SPOUSE_BIRTH_DT                INT,
    SPOUSE_EMPLOYER                STRING,
    SPOUSE_IDENTITY_VALUE          STRING,
    INCORPORATED_DT                INT,
    TOT_LIM_AMT                    DOUBLE,
    LIM_CCY                        INT,
    INCOME_CAT_ID    		   INT,
    INCOME_AMT                     DOUBLE,
    FLG_GLOBAL                     STRING,
    FLG_MINOR                      INT,
    FLG_STAFF                      INT,
    FLG_WALLET                     INT,
    FLG_INTERNETBANKING            INT,
    FLG_SAFEBOX                    INT,
    FLG_REPLICATE                  INT,
    FLG_CASA                       INT,
    FLG_CD                         INT,
    FLG_TD                         INT,
    FLG_DC                         INT,
    FLG_PPC                        INT,
    FLG_CC                         INT,
    FLG_LN                         INT,
    FLG_OVD                        INT,
    FLG_BANK_ASSURANCE             INT,
    FLG_MEMO                       INT,
    FLG_WATCH_LIST                 INT,
    WATCH_LIST_DT                  INT,
    FLG_BDC_CUST                   INT,
    SYSTEM_ID                      STRING,
    OFFICER_ID                     INT,
    MAKER_ID                       STRING,
    CHECKER_ID                     STRING,
    LAST_MNT_DT                    INT,
    ROWHASH			   STRING,
    BUSINESS_DT                    INT 
)CLUSTERED BY (DWH_ID,CIF,NATIONAL_ID) INTO 16 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");




INSERT INTO DWH_TST_DB.H_CUSTOMER
(
    CUST_ID                       ,
    DWH_ID                        ,
    CIF                           ,
    T24_ID			  ,
    CBE_REF_COD                   ,
    CUST_BRN_ID			  ,
    LIAB_NO                       ,
    OPEN_DT                       ,
    BIRTH_DT                      ,
    CUSTOMER_TYPE_ID              ,
    CUST_STATUS_ID                ,
    NATIONAL_ID			  ,
    SECONDARY_IDENTITY_ID         ,
    SECONDARY_IDENTITY_VALUE      ,
    CUST_TIN			  ,
    FULL_NAME_AR                  ,
    FIRST_NAME_AR                 ,
    MID_NAME_AR                   ,
    LAST_NAME_AR                  ,
    FULL_NAME_EN                  ,
    FIRST_NAME_EN                 ,
    MID_NAME_EN                   ,
    LAST_NAME_EN                  ,
    NATIONALITY                   ,
    EMAIL                         ,
    GENDER                        ,
    CUST_PREFIX                   ,
    LANGUAGE_ID                   ,
    GUARDIAN_TYPE                 ,
    SIGNATURE_ID                  ,
    BUSINESS_TYPE_ID              ,
    PROFESSION_ID                 ,
    MARITAL_STATUS_ID             ,
    CREDIT_RATING                 ,
    REVISION_DATE                 ,
    ADDR1                         ,
    ADDR2                         ,
    ADDR3                         ,
    ZIP_COD                       ,
    CITY                          ,
    FAX                           ,
    PERMN_ADDR1                   ,
    PERMN_ADDR2                   ,
    PERMN_ADDR3                   ,
    PERMN_CITY                    ,
    PERMN_ZIP_COD                 ,
    PERMN_GOV_ID                  ,
    PERMN_COUNTRY_ID              ,
    PHONE_NUM_1                   ,
    PHONE_NUM_2                   ,
    PHONE_NUM_3 /*TELEX*/	  ,
    CC_MOB_NUM                    ,
    WALLET_MOB_NUM                ,
    IB_MOB_NUM                    ,
    PPC_MOB_NUM                   ,
    DC_MOB_NUM                    ,
    IB_EMAIL                      ,
    CUST_OCCUPATION               ,
    CUST_DESIGNATION              ,
    CUST_SALARY                   ,
    SPOUSE_NAME_AR                ,
    SPOUSE_NAME_EN                ,
    MARRIAGE_DT                   ,
    SPOUSE_BIRTH_DT               ,
    SPOUSE_EMPLOYER               ,
    SPOUSE_IDENTITY_VALUE         ,
    INCORPORATED_DT               ,
    TOT_LIM_AMT                   ,
    LIM_CCY                       ,
    INCOME_CAT_ID    		  ,
    INCOME_AMT                    ,
    FLG_GLOBAL                    ,
    FLG_MINOR                     ,
    FLG_STAFF                     ,
    FLG_WALLET                    ,
    FLG_INTERNETBANKING           ,
    FLG_SAFEBOX                   ,
    FLG_REPLICATE                 ,
    FLG_CASA                      ,
    FLG_CD                        ,
    FLG_TD                        ,
    FLG_DC                        ,
    FLG_PPC                       ,
    FLG_CC                        ,
    FLG_LN                        ,
    FLG_OVD                       ,
    FLG_BANK_ASSURANCE            ,
    FLG_MEMO                      ,
    FLG_WATCH_LIST                ,
    WATCH_LIST_DT                 ,
    FLG_BDC_CUST                  ,
    SYSTEM_ID                     ,
    OFFICER_ID                    ,
    MAKER_ID                      ,
    CHECKER_ID                    ,
    LAST_MNT_DT                   ,
    ROWHASH			  ,
    BUSINESS_DT                   
)
SELECT
	ID                        , 
    DWH_ID                        , 
    CIF                           , 
    T24_ID			  ,
    CBE_REF_COD                   , 
    CUST_BRN_ID			  ,
    LIAB_NO                       , 
    OPEN_DT                       , 
    BIRTH_DT                      , 
    CUSTOMER_TYPE_ID              , 
    CUST_STATUS_ID                , 
    NATIONAL_ID			  ,
    SECONDARY_IDENTITY_ID         , 
    SECONDARY_IDENTITY_VALUE      , 
    CUST_TIN			  ,
    FULL_NAME_AR                  , 
    FIRST_NAME_AR                 , 
    MID_NAME_AR                   , 
    LAST_NAME_AR                  , 
    FULL_NAME_EN                  , 
    FIRST_NAME_EN                 , 
    MID_NAME_EN                   , 
    LAST_NAME_EN                  , 
    NATIONALITY                   , 
    EMAIL                         , 
    GENDER                        , 
    CUST_PREFIX                   , 
    LANGUAGE_ID                   , 
    GUARDIAN_TYPE                 , 
    SIGNATURE_ID                  , 
    BUSINESS_TYPE_ID              , 
    PROFESSION_ID                 , 
    MARITAL_STATUS_ID             , 
    CREDIT_RATING                 , 
    REVISION_DATE                 , 
    ADDR1                         , 
    ADDR2                         , 
    ADDR3                         , 
    ZIP_COD                       , 
    CITY                          , 
    FAX                           , 
    PERMN_ADDR1                   , 
    PERMN_ADDR2                   , 
    PERMN_ADDR3                   , 
    PERMN_CITY                    , 
    PERMN_ZIP_COD                 , 
    PERMN_GOV_ID                  , 
    PERMN_COUNTRY_ID              , 
    PHONE_NUM_1                   , 
    PHONE_NUM_2                   , 
    PHONE_NUM_3 /*TELEX*/	  ,
    CC_MOB_NUM                    , 
    WALLET_MOB_NUM                , 
    IB_MOB_NUM                    , 
    PPC_MOB_NUM                   , 
    DC_MOB_NUM                    , 
    IB_EMAIL                      , 
    CUST_OCCUPATION               , 
    CUST_DESIGNATION              , 
    CUST_SALARY                   , 
    SPOUSE_NAME_AR                , 
    SPOUSE_NAME_EN                , 
    MARRIAGE_DT                   , 
    SPOUSE_BIRTH_DT               , 
    SPOUSE_EMPLOYER               , 
    SPOUSE_IDENTITY_VALUE         , 
    INCORPORATED_DT               , 
    TOT_LIM_AMT                   , 
    LIM_CCY                       , 
    INCOME_CAT_ID    		  ,
    INCOME_AMT                    , 
    FLG_GLOBAL                    , 
    FLG_MINOR                     , 
    FLG_STAFF                     , 
    FLG_WALLET                    , 
    FLG_INTERNETBANKING           , 
    FLG_SAFEBOX                   , 
    FLG_REPLICATE                 , 
    FLG_CASA                      , 
    FLG_CD                        , 
    FLG_TD                        , 
    FLG_DC                        , 
    FLG_PPC                       , 
    FLG_CC                        , 
    FLG_LOAN                      , 
    FLG_OVD                       , 
    FLG_BANK_ASSURANCE            , 
    FLG_MEMO                      , 
    FLG_WATCH_LIST                , 
    WATCH_LIST_DT                 , 
    FLG_BDC_CUST                  , 
    SYSTEM_ID                     , 
    OFFICER_ID                    , 
    MAKER_ID                      , 
    CHECKER_ID                    , 
    LAST_MNT_DT                   , 
    ROWHASH			  ,
    BUSINESS_DT                    
FROM DWH_TST_DB.H_CUSTOMER_SP1;



/* DDL for Table H_WALLETS */


ALTER TABLE DWH_TST_DB.H_WALLETS RENAME TO DWH_TST_DB.H_WALLETS_SP1;

CREATE TABLE DWH_TST_DB.H_WALLETS (
    WALLET_ID                        INT,
    WALLET_CUST_ID                   STRING,
    CUST_ID                          INT,
    DWH_ID                           INT,
    NATIONAL_ID                      STRING,
    CUSTOMER_TYPE                    STRING,
    FIRST_NAME_AR                    STRING,
    MID_NAME_AR                      STRING,
    LAST_NAME_AR                     STRING,
    FULL_NAME_AR                     STRING,
    FIRST_NAME_EN                    STRING,
    MID_NAME_EN                      STRING,
    LAST_NAME_EN                     STRING,
    FULL_NAME_EN                     STRING,
    PROVIDER_ID                      INT,
    CITY                             STRING,
    TITLE                            STRING,
    BIRTH_DT                         INT,
    GENDER                           STRING,
    MARITAL_STATUS_ID                INT,
    MOB_NUM                          STRING,
    WALLET_STATUS_ID                 INT,
    WALLET_BAL                       DOUBLE,
    DISTRIBUTOR_COD                  INT,
    DISTRIBUTOR_NAME                 STRING,
    DISTRIBUTOR_BRANCH_ID            INT,
    KYCSTATUS                        STRING,
    PAN                              INT,
    WALLET_LIMIT_PROFILE             STRING,
    REGISTRATION_CHANNEL             STRING,
    FLG_SELF_REGISTRATION            STRING,
    SELF_REG_KYC_STATUS              STRING, 
    REGISTRATION_VERIFICATION_METHOD STRING,
    REGISTRATION_DT                  INT,
    UNREGISTRATION_DT                INT,
    ROWHASH			     			STRING,
    BUSINESS_DT                      INT
)CLUSTERED BY (MOB_NUM,NATIONAL_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


INSERT INTO DWH_TST_DB.H_WALLETS
(
    WALLET_ID                        ,
    WALLET_CUST_ID                   ,
    CUST_ID                          ,
    DWH_ID                           ,
    NATIONAL_ID                      ,
    CUSTOMER_TYPE                    ,
    FIRST_NAME_AR                    ,
    MID_NAME_AR                      ,
    LAST_NAME_AR                     ,
    FULL_NAME_AR                     ,
    FIRST_NAME_EN                    ,
    MID_NAME_EN                      ,
    LAST_NAME_EN                     ,
    FULL_NAME_EN                     ,
    PROVIDER_ID                      ,
    CITY                             ,
    TITLE                            ,
    BIRTH_DT                         ,
    GENDER                           ,
    MARITAL_STATUS_ID                ,
    MOB_NUM                          ,
    WALLET_STATUS_ID                 ,
    WALLET_BAL                       ,
    DISTRIBUTOR_COD                  ,
    DISTRIBUTOR_NAME                 ,
    DISTRIBUTOR_BRANCH_ID            ,
    KYCSTATUS                        ,
    PAN                              ,
    WALLET_LIMIT_PROFILE             ,
    REGISTRATION_CHANNEL             ,
    FLG_SELF_REGISTRATION            ,
    SELF_REG_KYC_STATUS              , 
    REGISTRATION_VERIFICATION_METHOD ,
    REGISTRATION_DT                  ,
    UNREGISTRATION_DT                ,
    ROWHASH			     ,
    BUSINESS_DT                      
)
SELECT
    ID                        	     ,
    WALLET_CUST_ID                   ,
    CUST_ID                          ,
    DWH_ID                           ,
    NATIONAL_ID                      ,
    CUSTOMER_TYPE                    ,
    FIRST_NAME_AR                    ,
    MID_NAME_AR                      ,
    LAST_NAME_AR                     ,
    FULL_NAME_AR                     ,
    FIRST_NAME_EN                    ,
    MID_NAME_EN                      ,
    LAST_NAME_EN                     ,
    FULL_NAME_EN                     ,
    PROVIDER_ID                      ,
    CITY                             ,
    TITLE                            ,
    BIRTH_DT                         ,
    GENDER                           ,
    MARITAL_STATUS_ID                ,
    MOBILE_NUM                       ,
    WALLET_STATUS_ID                 ,
    WALLET_BAL                       ,
    DISTRIBUTOR_COD                  ,
    DISTRIBUTOR_NAME                 ,
    DISTRIBUTOR_BRANCH_ID            ,
    KYCSTATUS                        ,
    PAN                              ,
    WALLET_LIMIT_PROFILE             ,
    REGISTRATION_CHANNEL             ,
    SELF_REGISTRATION_FLG            ,
    SELF_REG_KYC_STATUS              ,
    REGISTRATION_VERIFICATION_METHOD ,
    REGISTRATION_DT                  ,
    UNREGISTRATION_DT                ,
    ROWHASH			     ,
    BUSINESS_DT                      
FROM DWH_TST_DB.H_WALLETS_SP1;


/* DDL for Table H_BRANCH  */

ALTER TABLE DWH_TST_DB.H_BRANCH RENAME TO DWH_TST_DB.H_BRANCH_SP1;


CREATE TABLE DWH_TST_DB.H_BRANCH (
    BRN_ID   		  	     INT,
    BRN_COD            		     INT,
    CBE_BRN_COD        		     INT,
    BRN_CITY	       		     STRING,
    BRN_TYPE_ID        		     INT,
    BRN_GOV_ID	       		     INT,
    BRN_NAME_AR        		     STRING,
    BRN_NAME_AR_SHORT  		     STRING,
    BRN_NAME_EN        		     STRING,
    BRN_NAME_EN_SHORT  		     STRING,
    OPEN_DT            		     INT,
    CLOSE_DT           		     INT,
    ADDR1              		     STRING,
    ADDR2              		     STRING,
    ADDR3              		     STRING,
    ZIPCODE            		     STRING,
    CD_CC_BRN_XREF     		     INT,
    FLG_CLOSED         		     STRING,
    MIGRATED_TO        		     INT,
    LONGITUDE          		     DOUBLE,
    LATITUDE           		     DOUBLE,
    MAKER_ID           		     STRING,
    CHECKER_ID         		     STRING,
    LAST_MNT_DT        		     INT,
    ROWHASH			     STRING,
    BUSINESS_DT        		     INT
)CLUSTERED BY (BRN_COD) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");



INSERT INTO DWH_TST_DB.H_BRANCH
(
    BRN_ID   		  	   ,
    BRN_COD            		   ,
    CBE_BRN_COD        		   ,
    BRN_CITY	       		   ,
    BRN_TYPE_ID        		   ,
    BRN_GOV_ID	       		   ,
    BRN_NAME_AR        		   ,
    BRN_NAME_AR_SHORT  		   ,
    BRN_NAME_EN        		   ,
    BRN_NAME_EN_SHORT  		   ,
    OPEN_DT            		   ,
    CLOSE_DT           		   ,
    ADDR1              		   ,
    ADDR2              		   ,
    ADDR3              		   ,
    ZIPCODE            		   ,
    CD_CC_BRN_XREF     		   ,
    FLG_CLOSED         		   ,
    MIGRATED_TO        		   ,
    LONGITUDE          		   ,
    LATITUDE           		   ,
    MAKER_ID           		   ,
    CHECKER_ID         		   ,
    LAST_MNT_DT        		   ,
    ROWHASH			   ,
    BUSINESS_DT        		      
)
SELECT
    ID        		     	     ,
    BRN_COD            		     ,
    CBE_BRN_COD        		     ,
    BRN_CITY	       		     ,
    BRN_TYPE_ID        		     ,
    BRN_GOV_ID	       		     ,
    BRN_NAME_AR        		     ,
    BRN_NAME_AR_SHORT  		     ,
    BRN_NAME_EN        		     ,
    BRN_NAME_EN_SHORT  		     ,
    OPEN_DT            		     ,
    CLOSE_DT           		     ,
    ADDR1              		     ,
    ADDR2              		     ,
    ADDR3              		     ,
    ZIPCODE            		     ,
    CD_CC_BRN_XREF     		     ,
    FLG_CLOSED         		     ,
    MIGRATED_TO        		     ,
    LONGITUDE          		     ,
    LATITUDE           		     ,
    MAKER_ID           		     ,
    CHECKER_ID         		     ,
    LAST_MNT_DT        		     ,
    ROWHASH			     ,
    BUSINESS_DT        		     
FROM DWH_TST_DB.H_BRANCH_SP1;






/* DDL for Table H_BDC_USERS  */


ALTER TABLE DWH_TST_DB.H_BDC_USERS RENAME TO DWH_TST_DB.H_BDC_USERS_SP1;

CREATE TABLE DWH_TST_DB.H_BDC_USERS (
    BDC_USER_ID           		INT,
    USER_ID             		STRING,
    USER_NO             		INT,
    USER_NAME           		STRING,
    BRN_ID				INT,    
    SYSTEM_COD		    		STRING,
    FLG_STATUS          		STRING,
    FLG_MNT_STATUS      		STRING,
    COD_MNT_ACTION      		STRING,
    LAST_MNT_DT         		INT,
    ROWHASH			      	STRING,
    BUSINESS_DT     			INT
)CLUSTERED BY (USER_ID) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.H_BDC_USERS
(
    BDC_USER_ID           		,
    USER_ID             		,
    USER_NO             		,
    USER_NAME           		,
    BRN_ID				, 
    SYSTEM_COD		    		,
    FLG_STATUS          		,
    FLG_MNT_STATUS      		,
    COD_MNT_ACTION      		,
    LAST_MNT_DT         		,
    ROWHASH			     	,
    BUSINESS_DT     			
)
SELECT
    ID           			,
    USER_ID             		,
    USER_NO             		,
    USER_NAME           		,
    BRN_ID				, 
    SYSTEM_COD		    		,
    FLG_STATUS          		,
    FLG_MNT_STATUS      		,
    COD_MNT_ACTION      		,
    LAST_MNT_DT         		,
    ROWHASH			     	,
    BUSINESS_DT     	     
FROM DWH_TST_DB.H_BDC_USERS_SP1;



/* DDL for Table H_CURRENCY  */

ALTER TABLE DWH_TST_DB.H_CURRENCY RENAME TO DWH_TST_DB.H_CURRENCY_SP1;

CREATE TABLE DWH_TST_DB.H_CURRENCY (
    CCY_ID        			INT,
    CCY_COD          			INT,
    CCY_ISO_COD      			STRING,
    CBE_CCY_COD      			STRING,
    IST_CCY_COD      			INT,
    SHORT_NAME       			STRING,
    CCY_NAME_AR      			STRING,
    CCY_NAME_EN      			STRING,
    CCY_SYMBOL       			STRING,
    SWIFT_COD        			INT,
    CCY_DECIMAL_NAME 			STRING,
    DECIMAL_COD      			STRING,
    COUNTRY_ID       			INT,
    MAKER_ID		 		STRING,
    CHECKER_ID		 		STRING,
    LAST_MNT_DT	     			INT,
    ROWHASH			     	STRING,
    BUSINESS_DT	     			INT
)CLUSTERED BY (CCY_COD) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.H_CURRENCY
(
    CCY_ID        	,
    CCY_COD          	,
    CCY_ISO_COD      	,
    CBE_CCY_COD      	,
    IST_CCY_COD      	,
    SHORT_NAME       	,
    CCY_NAME_AR      	,
    CCY_NAME_EN      	,
    CCY_SYMBOL       	,
    SWIFT_COD        	,
    CCY_DECIMAL_NAME 	,
    DECIMAL_COD      	,
    COUNTRY_ID       	,
    MAKER_ID		,
    CHECKER_ID		,
    LAST_MNT_DT	     	,
    ROWHASH		,
    BUSINESS_DT	     	
)
SELECT
	ID        	,
    CCY_COD          	,
    CCY_ISO_COD      	,
    CBE_CCY_COD      	,
    IST_CCY_COD      	,
    SHORT_NAME       	,
    CCY_NAME_AR      	,
    CCY_NAME_EN      	,
    CCY_SYMBOL       	,
    SWIFT_COD        	,
    CCY_DECIMAL_NAME 	,
    DECIMAL_COD      	,
    COUNTRY_ID       	,
    MAKER_ID		,
    CHECKER_ID		,
    LAST_MNT_DT	     	,
    ROWHASH		,
    BUSINESS_DT	    
FROM DWH_TST_DB.H_CURRENCY_SP1;



/* DDL for Table H_BANK_ASSURANCE  */


ALTER TABLE DWH_TST_DB.H_BANK_ASSURANCE RENAME TO DWH_TST_DB.H_BANK_ASSURANCE_SP1;

CREATE TABLE DWH_TST_DB.H_BANK_ASSURANCE (
BANK_ASSURANCE_ID					INT,
CUST_ID							INT,
DWH_ID							INT,
NATIONAL_ID						STRING,
ACCT_NO							STRING,
CUST_NAME_EN						STRING,
CUST_NAME_AR						STRING,
BRN_COD							STRING,
ROWHASH			 			    	STRING,
BUSINESS_DT						INT
)CLUSTERED BY (NATIONAL_ID,ACCT_NO) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


INSERT INTO DWH_TST_DB.H_BANK_ASSURANCE
(
BANK_ASSURANCE_ID				,
CUST_ID						,
DWH_ID						,
NATIONAL_ID					,
ACCT_NO						,
CUST_NAME_EN					,
CUST_NAME_AR					,
BRN_COD						,
ROWHASH			 			,
BUSINESS_DT					
)
SELECT
ID						,
CUST_ID						,
DWH_ID						,
NATIONAL_ID					,
ACCT_NO						,
CUST_NAME_EN					,
CUST_NAME_AR					,
BRN_COD						,
ROWHASH			 			,
BUSINESS_DT					
FROM DWH_TST_DB.H_BANK_ASSURANCE_SP1;


---------------------------- F_CUST_MEMO ----------------------------
ALTER TABLE DWH_TST_DB.F_CUST_MEMO RENAME TO DWH_TST_DB.F_CUST_MEMO_SP1;

CREATE TABLE DWH_TST_DB.F_CUST_MEMO (
    CUST_MEMO_ID                    		INT,
    CUST_ID         	  			INT,
    DWH_ID     		  			INT,
    CIF        		  			STRING,
    CUST_MEMO_DT          			INT,
    TXT_CUST_MEMO         			STRING,
    FLG_SEVERITY          			STRING,
    MAKER_ID              			STRING,
    CHECKER_ID            			STRING,
    LAST_MNT_DT           			INT,
    BUSINESS_DT           			INT 
)CLUSTERED BY (CIF) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.F_CUST_MEMO (
	CUST_MEMO_ID                   	 	,
    CUST_ID         	  			,
    DWH_ID     		  			,
    CIF        		  			,
    CUST_MEMO_DT          			,
    TXT_CUST_MEMO         			,
    FLG_SEVERITY          			,
    MAKER_ID              			,
    CHECKER_ID            			,
    LAST_MNT_DT           			,
    BUSINESS_DT           			
)
SELECT 
	ID                    			,
    CUST_ID         	  			,
    DWH_ID     		  			,
    CIF        		  			,
    CUST_MEMO_DT          			,
    TXT_CUST_MEMO         			,
    FLG_SEVERITY          			,
    MAKER_ID              			,
    CHECKER_ID            			,
    LAST_MNT_DT           			,
    BUSINESS_DT           			
FROM DWH_TST_DB.F_CUST_MEMO_SP1;

---------------------------- F_CARDS ----------------------------
ALTER TABLE DWH_TST_DB.F_CARDS RENAME TO DWH_TST_DB.F_CARDS_SP1;

CREATE TABLE DWH_TST_DB.F_CARDS (
    F_CARDS_ID						INT,
	CARD_ID						INT,
	DWH_ID						INT,
	BAL						DOUBLE,
	DUE_AMT						DOUBLE,
	OVER_DUE_AMT					DOUBLE,
	OVER_DUE_DAYS					DOUBLE,
	OVER_LIM_AMT					DOUBLE,
	AMT_ON_HOLD					DOUBLE,
	ARRESTED_AMT					DOUBLE,
	RETAIL_BAL					DOUBLE,
	CASH_BAL					DOUBLE,
	FEES_BAL					DOUBLE,
	INTEREST_BAL					DOUBLE,
	PAYMENTS_BAL					DOUBLE,
	OTHERS_BAL					DOUBLE,
	MINIMUM_PAYMENT					DOUBLE,
	PAYMENT_DUE_DT					DOUBLE,
	SUSPENDED_ACCT_BAL				DOUBLE,
	REMAINING_CASH_LIM				DOUBLE,
	REMAINING_SALE_LIM				DOUBLE,
	INSTALLMENT_BAL					DOUBLE,
	FEES_BAL_MARGIN					DOUBLE,
	INTEREST_BAL_MARGIN				DOUBLE,
	CASH_WD_AMT_USED				DOUBLE,
	CASH_WD_COUNT					INT,
	CASH_WD_DT					INT,
	CASH_WD_TIME					INT,
	TC_WD_AMT_USED					DOUBLE,
	TC_WD_COUNT					INT,
	TC_WD_DT					INT,
	TC_WD_TIME					INT,
	PURCH_AMT_USED					DOUBLE,
	PURCH_COUNT					INT,
	PURCH_DT					INT,
	TABLENAME					STRING
	)
	PARTITIONED BY (BUSINESS_DT		INT
)
CLUSTERED BY (CARD_ID,DWH_ID) INTO 32 BUCKETS
STORED AS PARQUET
TBLPROPERTIES    ("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.F_CARDS (
	F_CARDS_ID						,
	CARD_ID							,
	DWH_ID							,
	BAL							,
	DUE_AMT							,
	OVER_DUE_AMT						,
	OVER_DUE_DAYS						,
	OVER_LIM_AMT						,
	AMT_ON_HOLD						,
	ARRESTED_AMT						,
	RETAIL_BAL						,
	CASH_BAL						,
	FEES_BAL						,
	INTEREST_BAL						,
	PAYMENTS_BAL						,
	OTHERS_BAL						,
	MINIMUM_PAYMENT						,
	PAYMENT_DUE_DT						,
	SUSPENDED_ACCT_BAL					,
	REMAINING_CASH_LIM					,
	REMAINING_SALE_LIM					,
	INSTALLMENT_BAL						,
	FEES_BAL_MARGIN						,
	INTEREST_BAL_MARGIN					,
	CASH_WD_AMT_USED					,
	CASH_WD_COUNT						,
	CASH_WD_DT						,
	CASH_WD_TIME						,
	TC_WD_AMT_USED						,
	TC_WD_COUNT						,
	TC_WD_DT						,
	TC_WD_TIME						,
	PURCH_AMT_USED						,
	PURCH_COUNT						,
	PURCH_DT						,
	TABLENAME						,
	BUSINESS_DT						
)
SELECT 
	ID							,
	CARD_ID							,
	DWH_ID							,
	BAL							,
	DUE_AMT							,
	OVER_DUE_AMT						,
	OVER_DUE_DAYS						,
	OVER_LIM_AMT						,
	AMT_ON_HOLD						,
	ARRESTED_AMT						,
	RETAIL_BAL						,
	CASH_BAL						,
	FEES_BAL						,
	INTEREST_BAL						,
	PAYMENTS_BAL						,
	OTHERS_BAL						,
	MINIMUM_PAYMENT						,
	PAYMENT_DUE_DT						,
	SUSPENDED_ACCT_BAL					,
	REMAINING_CASH_LIM					,
	REMAINING_SALE_LIM					,
	INSTALLMENT_BAL						,
	FEES_BAL_MARGIN						,
	INTEREST_BAL_MARGIN					,
	CASH_WD_AMT_USED					,
	CASH_WD_COUNT						,
	CASH_WD_DT						,
	CASH_WD_TIME						,
	TC_WD_AMT_USED						,
	TC_WD_COUNT						,
	TC_WD_DT						,
	TC_WD_TIME						,
	PURCH_AMT_USED						,
	PURCH_COUNT						,
	PURCH_DT						,
	TABLENAME						,
	BUSINESS_DT						
FROM DWH_TST_DB.F_CARDS_SP1;

---------------------------- F_ATM_TRX ----------------------------
ALTER TABLE DWH_TST_DB.F_ATM_TRX RENAME TO DWH_TST_DB.F_ATM_TRX_SP1;

CREATE TABLE DWH_TST_DB.F_ATM_TRX (
    ATM_TRX_ID							INT,
	MSGTYPE							INT,
	FLIPPED_MSGTYPE						INT,
	PAN							STRING,
	PAN_ID							INT,
	MASK_PAN						STRING,
	PCODE							INT,
	PCODE_ID						INT,
	TXNTYPE							INT,
	AMOUNT							DOUBLE,
	AVAL_BALANCE						DOUBLE,
	AMOUNT_EQUIV						DOUBLE,
	CASH_BACK						DOUBLE,
	ISS_CONV_RATE						DOUBLE,
	ISS_CURRENCY_CODE					INT,
	ISS_CONV_DATE						INT,
	ACQ_CONV_RATE						DOUBLE,
	ACQ_CURRENCY_CODE					INT,
	ACQ_CONV_DATE						INT,
	TRA_AMOUNT						DOUBLE,
	TRA_CONV_RATE						DOUBLE,
	TRA_CURRENCY_CODE					INT,
	TRA_CONV_DATE						INT,
	FEE							DOUBLE,
	NEW_FEE							DOUBLE,
	NEW_AMOUNT						DOUBLE,
	NEW_SETL_AMOUNT						DOUBLE,
	SETTLEMENT_FEE						DOUBLE,
	SETTLEMENT_RATE						DOUBLE,
	SETTLEMENT_CODE						INT,
	SETTLEMENT_AMOUNT					DOUBLE,
	TRANDATE						INT,
	TRANTIME						INT,
	TRACE							INT,
	LOCAL_TIME						INT,
	LOCAL_DATE						INT,
	SETTLEMENT_DATE						INT,
	CAP_DATE						INT,
	POS_ENTRY_CODE						INT,
	POS_CONDITION_CODE					INT,
	POS_PIN_CAP_CODE					STRING,
	POS_CAP_CODE						INT,
	LIFE_CYCLE						INT,
	ACQUIRER						STRING,
	ISSUER							STRING,
	TRANSFEREE						STRING,
	ORIGINATOR						STRING,
	MEMBER_ID						STRING,
	F_ID							STRING,
	TXNSRC							STRING,
	TXNDEST							STRING,
	ALTERNATEACQUIRER					STRING,
	ENTITYID						STRING,
	ISS_ENTITYID						STRING,
	CARDPRODUCT						STRING,
	MVV							STRING,
	INVOICE_NUMBER						STRING,
	TRANS_ID						STRING,
	FPI							STRING,
	TXN_START_TIME 						INT,
	TXN_END_TIME 						INT,
	DEVICE_CAP						INT,
	RESPCODE						INT,
	REASON_CODE						INT,
	REVCODE							INT,
	SHCERROR						INT,
	SAF							INT,
	ORIGMSG							INT,
	ORIGFLIPPEDMSG						INT,
	ORIGTRACE						INT,
	ORIGDATE						INT,
	ORIGTIME						INT,
	MERCHANT_TYPE						INT,
	ACQ_COUNTRY						INT,
	REFNUM							STRING,
	AUTHNUM							STRING,
	TERMID_ID						INT,
	TERMID							STRING,
	ACCEPTORNAME						STRING,
	TERMLOC							STRING,
	ADDRESPONSE						STRING,
	ACCTNUM							STRING,
	BRANCH							INT,
	SERIAL_1						INT,
	SERIAL_2						INT,
	STOREID							INT,
	LANE							INT,
	TERMINAL_TRACE						INT,
	CHECKER_ID						INT,
	SUPERVISOR						INT,
	SHIFT_NUMBER						INT,
	BATCH_ID						INT,
	DEVICE_DEVCAP						INT,
	SHC_DEVCAP						INT,
	FORMATTER_DEVCAP					INT,
	AUTH_DEVCAP						INT,
	FILLER1							STRING,
	FILLER2							STRING,
	FILLER3							STRING,
	FILLER4							STRING,
	ISSUER_DATA						STRING,
	ACQUIRER_DATA						STRING,
	NEW_AMOUNT_EQUIV					DOUBLE,
	ACQ_AVAL_BALANCE					DOUBLE,
	ACQ_LEDGER_BALANCE					DOUBLE,
	SETL_AVAL_BALANCE					DOUBLE,
	SETL_LEDGER_BALANCE					DOUBLE,
	AVAL_BALANCE_TYPE					INT,
	LEDGER_BALANCE_TYPE					INT,
	NEW_SETL_FEE						DOUBLE,
	TXN_AMOUNT						DOUBLE,
	TXN_NEW_AMOUNT						DOUBLE,
	TXN_CURRENCY_CODE					INT,
	TXN_CONV_RATE						DOUBLE,
	TXN_CONV_DATE						INT,
	CH_AMOUNT						DOUBLE,
	CH_NEW_AMOUNT						DOUBLE,
	CH_CURRENCY_CODE					INT,
	CH_CONV_RATE						DOUBLE,
	CH_CONV_DATE						INT,
	LEDGER_BALANCE						DOUBLE,
	SLOT_NUM						INT ,
	DEVICE_FEE						DOUBLE ,
	CARD_SEQNO						INT ,
	ALPHARESPONSECODE					STRING,
	CHIP_TYPE						STRING,
	CHIP_INDEX						STRING,
	PROCESSOR_BUSDAY					INT,
	SEQ_TRACE_NO						INT ,
	SEG_REQ							STRING,
	SEG_RESP						STRING,
	SITE_ID							INT,
	VERSION							INT,
	SRC_NODE						INT,
	DEST_NODE						INT,
	SHC_DATA_BUFFER					STRING)
	PARTITIONED BY (BUSINESS_DT		INT
)
CLUSTERED BY (PCODE,TERMID) INTO 32 BUCKETS
STORED AS PARQUET
TBLPROPERTIES    ("PARQUET.COMPRESSION"="SNAPPY");


INSERT INTO DWH_TST_DB.F_ATM_TRX (
    ATM_TRX_ID							,
	MSGTYPE							,
	FLIPPED_MSGTYPE						,
	PAN							,
	PAN_ID							,
	MASK_PAN						,
	PCODE							,
	PCODE_ID						,
	TXNTYPE							,
	AMOUNT							,
	AVAL_BALANCE						,
	AMOUNT_EQUIV						,
	CASH_BACK						,
	ISS_CONV_RATE						,
	ISS_CURRENCY_CODE					,
	ISS_CONV_DATE						,
	ACQ_CONV_RATE						,
	ACQ_CURRENCY_CODE					,
	ACQ_CONV_DATE						,
	TRA_AMOUNT						,
	TRA_CONV_RATE						,
	TRA_CURRENCY_CODE					,
	TRA_CONV_DATE						,
	FEE							,
	NEW_FEE							,
	NEW_AMOUNT						,
	NEW_SETL_AMOUNT						,
	SETTLEMENT_FEE						,
	SETTLEMENT_RATE						,
	SETTLEMENT_CODE						,
	SETTLEMENT_AMOUNT					,
	TRANDATE						,
	TRANTIME						,
	TRACE							,
	LOCAL_TIME						,
	LOCAL_DATE						,
	SETTLEMENT_DATE						,
	CAP_DATE						,
	POS_ENTRY_CODE						,
	POS_CONDITION_CODE					,
	POS_PIN_CAP_CODE					,
	POS_CAP_CODE						,
	LIFE_CYCLE						,
	ACQUIRER						,
	ISSUER							,
	TRANSFEREE						,
	ORIGINATOR						,
	MEMBER_ID						,
	F_ID							,
	TXNSRC							,
	TXNDEST							,
	ALTERNATEACQUIRER					,
	ENTITYID						,
	ISS_ENTITYID						,
	CARDPRODUCT						,
	MVV							,
	INVOICE_NUMBER						,
	TRANS_ID						,
	FPI							,
	TXN_START_TIME 						,
	TXN_END_TIME 						,
	DEVICE_CAP						,
	RESPCODE						,
	REASON_CODE						,
	REVCODE							,
	SHCERROR						,
	SAF							,
	ORIGMSG							,
	ORIGFLIPPEDMSG						,
	ORIGTRACE						,
	ORIGDATE						,
	ORIGTIME						,
	MERCHANT_TYPE						,
	ACQ_COUNTRY						,
	REFNUM							,
	AUTHNUM							,
	TERMID_ID						,
	TERMID							,
	ACCEPTORNAME						,
	TERMLOC							,
	ADDRESPONSE						,
	ACCTNUM							,
	BRANCH							,
	SERIAL_1						,
	SERIAL_2						,
	STOREID							,
	LANE							,
	TERMINAL_TRACE						,
	CHECKER_ID						,
	SUPERVISOR						,
	SHIFT_NUMBER						,
	BATCH_ID						,
	DEVICE_DEVCAP						,
	SHC_DEVCAP						,
	FORMATTER_DEVCAP					,
	AUTH_DEVCAP						,
	FILLER1							,
	FILLER2							,
	FILLER3							,
	FILLER4							,
	ISSUER_DATA						,
	ACQUIRER_DATA						,
	NEW_AMOUNT_EQUIV					,
	ACQ_AVAL_BALANCE					,
	ACQ_LEDGER_BALANCE					,
	SETL_AVAL_BALANCE					,
	SETL_LEDGER_BALANCE					,
	AVAL_BALANCE_TYPE					,
	LEDGER_BALANCE_TYPE					,
	NEW_SETL_FEE						,
	TXN_AMOUNT						,
	TXN_NEW_AMOUNT						,
	TXN_CURRENCY_CODE					,
	TXN_CONV_RATE						,
	TXN_CONV_DATE						,
	CH_AMOUNT						,
	CH_NEW_AMOUNT						,
	CH_CURRENCY_CODE					,
	CH_CONV_RATE						,
	CH_CONV_DATE						,
	LEDGER_BALANCE						,
	SLOT_NUM						,
	DEVICE_FEE						,
	CARD_SEQNO						,
	ALPHARESPONSECODE					,
	CHIP_TYPE						,
	CHIP_INDEX						,
	PROCESSOR_BUSDAY					,
	SEQ_TRACE_NO						,
	SEG_REQ							,
	SEG_RESP						,
	SITE_ID							,
	VERSION							,
	SRC_NODE						,
	DEST_NODE						,
	SHC_DATA_BUFFER						,
	BUSINESS_DT						
)
SELECT 
    ID								,
	MSGTYPE							,
	FLIPPED_MSGTYPE						,
	PAN							,
	PAN_ID							,
	MASK_PAN						,
	PCODE							,
	PCODE_ID						,
	TXNTYPE							,
	AMOUNT							,
	AVAL_BALANCE						,
	AMOUNT_EQUIV						,
	CASH_BACK						,
	ISS_CONV_RATE						,
	ISS_CURRENCY_CODE					,
	ISS_CONV_DATE						,
	ACQ_CONV_RATE						,
	ACQ_CURRENCY_CODE					,
	ACQ_CONV_DATE						,
	TRA_AMOUNT						,
	TRA_CONV_RATE						,
	TRA_CURRENCY_CODE					,
	TRA_CONV_DATE						,
	FEE							,
	NEW_FEE							,
	NEW_AMOUNT						,
	NEW_SETL_AMOUNT						,
	SETTLEMENT_FEE						,
	SETTLEMENT_RATE						,
	SETTLEMENT_CODE						,
	SETTLEMENT_AMOUNT					,
	TRANDATE						,
	TRANTIME						,
	TRACE							,
	LOCAL_TIME						,
	LOCAL_DATE						,
	SETTLEMENT_DATE						,
	CAP_DATE						,
	POS_ENTRY_CODE						,
	POS_CONDITION_CODE					,
	POS_PIN_CAP_CODE					,
	POS_CAP_CODE						,
	LIFE_CYCLE						,
	ACQUIRER						,
	ISSUER							,
	TRANSFEREE						,
	ORIGINATOR						,
	MEMBER_ID						,
	F_ID							,
	TXNSRC							,
	TXNDEST							,
	ALTERNATEACQUIRER					,
	ENTITYID						,
	ISS_ENTITYID						,
	CARDPRODUCT						,
	MVV							,
	INVOICE_NUMBER						,
	TRANS_ID						,
	FPI							,
	TXN_START_TIME 						,
	TXN_END_TIME 						,
	DEVICE_CAP						,
	RESPCODE						,
	REASON_CODE						,
	REVCODE							,
	SHCERROR						,
	SAF							,
	ORIGMSG							,
	ORIGFLIPPEDMSG						,
	ORIGTRACE						,
	ORIGDATE						,
	ORIGTIME						,
	MERCHANT_TYPE						,
	ACQ_COUNTRY						,
	REFNUM							,
	AUTHNUM							,
	TERMID_ID						,
	TERMID							,
	ACCEPTORNAME						,
	TERMLOC							,
	ADDRESPONSE						,
	ACCTNUM							,
	BRANCH							,
	SERIAL_1						,
	SERIAL_2						,
	STOREID							,
	LANE							,
	TERMINAL_TRACE						,
	CHECKER_ID						,
	SUPERVISOR						,
	SHIFT_NUMBER						,
	BATCH_ID						,
	DEVICE_DEVCAP						,
	SHC_DEVCAP						,
	FORMATTER_DEVCAP					,
	AUTH_DEVCAP						,
	FILLER1							,
	FILLER2							,
	FILLER3							,
	FILLER4							,
	ISSUER_DATA						,
	ACQUIRER_DATA						,
	NEW_AMOUNT_EQUIV					,
	ACQ_AVAL_BALANCE					,
	ACQ_LEDGER_BALANCE					,
	SETL_AVAL_BALANCE					,
	SETL_LEDGER_BALANCE					,
	AVAL_BALANCE_TYPE					,
	LEDGER_BALANCE_TYPE					,
	NEW_SETL_FEE						,
	TXN_AMOUNT						,
	TXN_NEW_AMOUNT						,
	TXN_CURRENCY_CODE					,
	TXN_CONV_RATE						,
	TXN_CONV_DATE						,
	CH_AMOUNT						,
	CH_NEW_AMOUNT						,
	CH_CURRENCY_CODE					,
	CH_CONV_RATE						,
	CH_CONV_DATE						,
	LEDGER_BALANCE						,
	SLOT_NUM						,
	DEVICE_FEE						,
	CARD_SEQNO						,
	ALPHARESPONSECODE					,
	CHIP_TYPE						,
	CHIP_INDEX						,
	PROCESSOR_BUSDAY					,
	SEQ_TRACE_NO						,
	SEG_REQ							,
	SEG_RESP						,
	SITE_ID							,
	VERSION							,
	SRC_NODE						,
	DEST_NODE						,
	SHC_DATA_BUFFER						,
	BUSINESS_DT						
FROM DWH_TST_DB.F_ATM_TRX_SP1;

---------------------------- F_EXCHANGE_RATE  ----------------------------
ALTER TABLE DWH_TST_DB.F_EXCHANGE_RATE RENAME TO DWH_TST_DB.F_EXCHANGE_RATE_SP1;

CREATE TABLE DWH_TST_DB.F_EXCHANGE_RATE (
    EXCHANGE_RAT_ID					INT,
	RAT_CCY_BOOK					DOUBLE,
	RAT_CCY_MID					DOUBLE,
	RAT_NOTE_BUY_SPRD				DOUBLE,
	RAT_CHQ_BUY_SPRD				DOUBLE,
	RAT_NOTE_SELL_SPRD				DOUBLE,
	RAT_CHQ_SELL_SPRD				DOUBLE,
	RAT_XFER_BUY_SPRD				DOUBLE,
	RAT_XFER_SELL_SPRD				DOUBLE,
	RAT_CCY_CB					DOUBLE,
	RAT_CCY_SPECIAL_1				DOUBLE,
	RAT_CCY_SPECIAL_2				DOUBLE,
	CCY_ID						INT,
	MAKER_ID					STRING,
	CHECKER_ID					STRING,
	EFFECTIVE_DT					INT,
	LAST_MNT_DT					INT)
	PARTITIONED BY (BUSINESS_DT		INT
)
CLUSTERED BY (CCY_ID) INTO 16 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.F_EXCHANGE_RATE (
    EXCHANGE_RAT_ID					,
	RAT_CCY_BOOK					,
	RAT_CCY_MID					,
	RAT_NOTE_BUY_SPRD				,
	RAT_CHQ_BUY_SPRD				,
	RAT_NOTE_SELL_SPRD				,
	RAT_CHQ_SELL_SPRD				,
	RAT_XFER_BUY_SPRD				,
	RAT_XFER_SELL_SPRD				,
	RAT_CCY_CB					,
	RAT_CCY_SPECIAL_1				,
	RAT_CCY_SPECIAL_2				,
	CCY_ID						,
	MAKER_ID					,
	CHECKER_ID					,
	EFFECTIVE_DT					,
	LAST_MNT_DT					,
	BUSINESS_DT						
)
SELECT 
    ID							,
	RAT_CCY_BOOK					,
	RAT_CCY_MID					,
	RAT_NOTE_BUY_SPRD				,
	RAT_CHQ_BUY_SPRD				,
	RAT_NOTE_SELL_SPRD				,
	RAT_CHQ_SELL_SPRD				,
	RAT_XFER_BUY_SPRD				,
	RAT_XFER_SELL_SPRD				,
	RAT_CCY_CB					,
	RAT_CCY_SPECIAL_1				,
	RAT_CCY_SPECIAL_2				,
	CCY_ID						,
	MAKER_ID					,
	CHECKER_ID					,
	EFFECTIVE_DT					,
	LAST_MNT_DT					,
	BUSINESS_DT					
FROM DWH_TST_DB.F_EXCHANGE_RATE_SP1;

---------------------------- H_INTERNET_BANKING  ----------------------------
ALTER TABLE DWH_TST_DB.H_INTERNET_BANKING RENAME TO DWH_TST_DB.H_INTERNET_BANKING_SP1;

CREATE TABLE DWH_TST_DB.H_INTERNET_BANKING (
    INTERNET_BANKING_ID					INT,
	CIF						STRING,
	DWH_ID						INT,
	CUST_NAME_EN					STRING,
	CUST_NAME_AR					STRING ,
	USER_ID	  					STRING,
	USER_STATUS_ID					INT ,
	MOB_NO	  					STRING,
	CREATED_BY					INT,
	CREATED_DT					INT,
	UPDATED_BY					INT,
	UPDATED_DT					INT,
	COMMERCIAL_REGISTER				STRING ,
	EMAIL_ID					STRING ,
	CUST_BRN					STRING,
	BASE_ROLE_ID					INT,
	USER_LEVEL_ID					INT,
	PRODUCT_ROLE_ID					INT,
	TOKEN_TYPE					STRING ,
	SERIAL_NUM					STRING ,
	IS_FIRST_TIME_USER				STRING ,
	IS_ACTIVE_PASSWORD				STRING ,
	IS_ACTIVE_TOKEN					STRING ,
	CUST_SEGMENT					STRING,
	RISK_RATING					STRING,
	ONLINE_REGISTRATION				STRING,
	DOC_SUBMITTED					STRING,
	ROWHASH			     			STRING,
	BUSINESS_DT					INT
)
CLUSTERED BY (CIF,DWH_ID) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.H_INTERNET_BANKING (
    INTERNET_BANKING_ID					,
	CIF						,
	DWH_ID						,
	CUST_NAME_EN					,
	CUST_NAME_AR					,
	USER_ID	  					,
	USER_STATUS_ID					,
	MOB_NO	  					,
	CREATED_BY					,
	CREATED_DT					,
	UPDATED_BY					,
	UPDATED_DT					,
	COMMERCIAL_REGISTER				,
	EMAIL_ID					,
	CUST_BRN					,
	BASE_ROLE_ID					,
	USER_LEVEL_ID					,
	PRODUCT_ROLE_ID					,
	TOKEN_TYPE					,
	SERIAL_NUM					,
	IS_FIRST_TIME_USER				,
	IS_ACTIVE_PASSWORD				,
	IS_ACTIVE_TOKEN					,
	CUST_SEGMENT					,
	RISK_RATING					,
	ONLINE_REGISTRATION				,
	DOC_SUBMITTED					,
	ROWHASH			     			,
	BUSINESS_DT						
)
SELECT 
    ID								,
	CIF							,
	DWH_ID							,
	CUST_NAME_EN						,
	CUST_NAME_AR						,
	USER_ID	  						,
	USER_STATUS_ID						,
	MOB_NO	  						,
	CREATED_BY						,
	CREATED_DT						,
	UPDATED_BY						,
	UPDATED_DT						,
	COMMERCIAL_REGISTER					,
	EMAIL_ID						,
	CUST_BRN						,
	BASE_ROLE_ID						,
	USER_LEVEL_ID						,
	PRODUCT_ROLE_ID						,
	TOKEN_TYPE						,
	SERIAL_NUM						,
	IS_FIRST_TIME_USER					,
	IS_ACTIVE_PASSWORD					,
	IS_ACTIVE_TOKEN						,
	CUST_SEGMENT						,
	RISK_RATING						,
	ONLINE_REGISTRATION					,
	DOC_SUBMITTED						,
	ROWHASH			     				,
	BUSINESS_DT						
FROM DWH_TST_DB.H_INTERNET_BANKING_SP1;

---------------------------- H_ATM  ----------------------------
ALTER TABLE DWH_TST_DB.H_ATM RENAME TO DWH_TST_DB.H_ATM_SP1;

CREATE TABLE DWH_TST_DB.H_ATM (
    ATM_ID							INT,
	TERMID							STRING,
	UNIT							INT,
	INSTITUTIONID						STRING,
	GROUP_NAME						STRING,
	GOSERVICE						STRING,
	MODEL							INT,
	MAKE							STRING,
	LOCAL_PIN						STRING,
	ADD_TOTAL						STRING,
	TXN_ALLOW						STRING,
	CURRENCY						INT,
	LOCATION						STRING,
	LOGGING							STRING,
	GEO_LOC							STRING,
	ACCEPTORNAME						STRING,
	O_ROWID							INT,
	H_LOCATION						STRING,
	WD_NO_RPT						INT,
	TIME_OFFSET						INT,
	MAC_REQUIRED						STRING,
	MAC_NCR_TXNREQ						STRING,
	MAC_NCR_TXNREPLY					STRING,
	MAC_NCR_SOLITSTAT					STRING,
	MAC_NCR_OTHER						STRING,
	MAC_NCR_TRACK1						STRING,
	MAC_NCR_TRACK2						STRING,
	MAC_NCR_TRACK3						STRING,
	FUNC_FLAGS						STRING,
	MAXDISPENSE						INT,
	TERM_COMP						STRING,
	HDL_ACK							STRING,
	MAC_NCR_EMV						STRING,
	PRIORITY_ROUTING					STRING,
	INTERNAL_UNIT						INT,
	FIT_LIST_ID						INT,
	CASSETTE_CFG_ID						INT,
	DISPENSE_TABLE_ID					INT,
	MANUFACTURER						STRING,
	EMULATION						STRING,
	MAX_COIN_DISPENSE					INT,
	ROWHASH			     				STRING,
	BUSINESS_DT						INT
)
CLUSTERED BY (TERMID) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

INSERT INTO DWH_TST_DB.H_ATM (
    ATM_ID							,
	TERMID							,
	UNIT							,
	INSTITUTIONID						,
	GROUP_NAME						,
	GOSERVICE						,
	MODEL							,
	MAKE							,
	LOCAL_PIN						,
	ADD_TOTAL						,
	TXN_ALLOW						,
	CURRENCY						,
	LOCATION						,
	LOGGING							,
	GEO_LOC							,
	ACCEPTORNAME						,
	O_ROWID							,
	H_LOCATION						,
	WD_NO_RPT						,
	TIME_OFFSET						,
	MAC_REQUIRED						,
	MAC_NCR_TXNREQ						,
	MAC_NCR_TXNREPLY					,
	MAC_NCR_SOLITSTAT					,
	MAC_NCR_OTHER						,
	MAC_NCR_TRACK1						,
	MAC_NCR_TRACK2						,
	MAC_NCR_TRACK3						,
	FUNC_FLAGS						,
	MAXDISPENSE						,
	TERM_COMP						,
	HDL_ACK							,
	MAC_NCR_EMV						,
	PRIORITY_ROUTING					,
	INTERNAL_UNIT						,
	FIT_LIST_ID						,
	CASSETTE_CFG_ID						,
	DISPENSE_TABLE_ID					,
	MANUFACTURER						,
	EMULATION						,
	MAX_COIN_DISPENSE					,
	ROWHASH			     				,
	BUSINESS_DT						
)
SELECT 
    ID								,
	TERMID							,
	UNIT							,
	INSTITUTIONID						,
	GROUP_NAME						,
	GOSERVICE						,
	MODEL							,
	MAKE							,
	LOCAL_PIN						,
	ADD_TOTAL						,
	TXN_ALLOW						,
	CURRENCY						,
	LOCATION						,
	LOGGING							,
	GEO_LOC							,
	ACCEPTORNAME						,
	O_ROWID							,
	H_LOCATION						,
	WD_NO_RPT						,
	TIME_OFFSET						,
	MAC_REQUIRED						,
	MAC_NCR_TXNREQ						,
	MAC_NCR_TXNREPLY					,
	MAC_NCR_SOLITSTAT					,
	MAC_NCR_OTHER						,
	MAC_NCR_TRACK1						,
	MAC_NCR_TRACK2						,
	MAC_NCR_TRACK3						,
	FUNC_FLAGS						,
	MAXDISPENSE						,
	TERM_COMP						,
	HDL_ACK							,
	MAC_NCR_EMV						,
	PRIORITY_ROUTING					,
	INTERNAL_UNIT						,
	FIT_LIST_ID						,
	CASSETTE_CFG_ID						,
	DISPENSE_TABLE_ID					,
	MANUFACTURER						,
	EMULATION						,
	MAX_COIN_DISPENSE					,
	ROWHASH			     				,
	BUSINESS_DT						
FROM DWH_TST_DB.H_ATM_SP1;


