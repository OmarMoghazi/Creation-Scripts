DROP TABLE DWH_TST_DB.L_REASON_CODES;
CREATE TABLE DWH_TST_DB.L_REASON_CODES(
REASON_ID			INT,
REASON_COD			INT,
TXT_DESC			String,
CTR_UPDAT_SRL_NUM		INT,
TASK_COD			String,
MAKER_ID			String,
CHECKER_ID			String,
LAST_MNT_DT			INT,
BUSINESS_DT			INT
)CLUSTERED BY (REASON_COD,TASK_COD) INTO 1 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.F_ACCOUNTS_LIMITS;
CREATE TABLE DWH_TST_DB.F_ACCOUNTS_LIMITS(
	ACCT_LIM_ID						INT,
	DWH_ID							INT,
	CCY_ID							INT,
	LIM_NUM							String,
	PARENT_LIM_NUM						String,
	SECURED_FLG						String,
	LIM_AMT							DOUBLE,
	LIM_START_DT						INT,
	LIM_END_DT						INT,
	LIM_INTEREST_RAT					DOUBLE,
	LIM_VAR_ACCT						DOUBLE,
	LIM_VAR_OVD						DOUBLE,
	EFFECTIVE_INT_RAT					DOUBLE,
	REPORTING_AMT						DOUBLE,
	AVAILABLE_AMT						DOUBLE,
	UTILISATION_AMT						DOUBLE,
	COLLATERAL_PCT						DOUBLE,
	REASON_ID						INT,
	UNCOLLECTED_AMT						DOUBLE,
	REMARKS							String,
	INTERNAL_FD_FLG						String,
	INT_INDX_COD						INT,
	CCY_RESTRICTION						String,
	LAST_NEW_UTILISATION_DT					INT,
	AVAILABILITY_FLG					String,
	COLLATERAL_CONTRIBUTION					DOUBLE,
	UNCOLLECTED_FUNDS_LIM					DOUBLE,
	FIRST_OVD_DT						INT,
	LAST_OVD_DT						INT,
	AMT_UTILIZED_TODAY					DOUBLE,
	AMT_REINSTATED_TODAY					DOUBLE,
	EXCESS_TENOR						DOUBLE,
	MATURED_UTILISATION					DOUBLE,
	RECORD_STAT						String,
	AUTH_STAT						String,
	MOD_NUM							INT,
	ONCE_AUTH						String,
	LIAB_BR							String,
	TABLE_NAME						String,
	MAKER_ID						String,
	CHECKER_ID						String,
	LAST_MNT_DT						INT,
	BUSINESS_DT						INT
)CLUSTERED BY (LIM_NUM) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.B_ACCOUNTS_LIMITS;
CREATE TABLE DWH_TST_DB.B_ACCOUNTS_LIMITS(
	ACCT_ID			INT,
	DWH_ID			INT,
	ACCT_LIM_ID		INT,
	PARENT_LIM_ID		INT,
	TABLE_NAME		String,
	BUSINESS_DT		INT
)CLUSTERED BY (ACCT_ID,ACCT_LIM_ID) INTO 4 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.L_ARREAR_TYPE;
CREATE TABLE DWH_TST_DB.L_ARREAR_TYPE(
	ARREARS_TYPE_ID		INT,
	ARREARS_TYPE_COD	String,
	ARREARS_TYPE_DESC	String,
	BUSINESS_DT		INT
)CLUSTERED BY (ARREARS_TYPE_COD) INTO 1 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.F_ARREARS;
CREATE TABLE DWH_TST_DB.F_ARREARS(
	ARREARS_ID				INT,
	ACCT_ID					INT,
	CCY_ID					INT,
	MODULE_ID				INT,
	ARREARS_TYPE_ID				INT,
	REF_BILL_NUM_SRL			INT,
	ARREARS_ASSESSED_AMT			DOUBLE,
	ARREARS_DUE_AMT				DOUBLE,
	ARREARS_CHARGE_COD			INT,
	INSTAL_NUM_CTR				INT,
	SEQ_NUM_CTR				INT,
	ARREARS_DUE_DT				INT,
	LAST_PAYMENT_DT				INT,
	REF_BILLNO_DT				INT,
	Business_DT				INT
)CLUSTERED BY (MODULE_ID,ACCT_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.F_LN_ACCT_SCHEDULE;
CREATE TABLE DWH_TST_DB.F_LN_ACCT_SCHEDULE(
	ACCT_SCHEDULE_ID				INT,
	ACCT_ID						INT,
	CTR_STAGE_AMD_NUM				INT,
	AMD_DT						INT,
	CTR_STAGE_NUM					INT, 
	OPN_BAL_AMT					DOUBLE,
	OPEN_BAL_AMT_ID					INT,
	STAGE_TYPE_ID					INT,
	INSTAL_LST_CTR					INT,
	INT_RAT						DOUBLE,
	INSTAL_AMT					DOUBLE,
	DT_FIRST_INSTAL					INT,
	CTR_INSTAL					DOUBLE, 
	FRQ_INSTAL					DOUBLE, 
	FIRST_INT_DT					INT,
	INT_FRQ						INT, 
	INT_CTR						INT, 
	Maker_ID					String,
	Checker_ID					String,
	LAST_MNT_DT					INT,
	Business_DT					INT
)CLUSTERED BY (ACCT_ID,CTR_STAGE_AMD_NUM,CTR_STAGE_NUM,AMD_DT) INTO 8 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.L_LN_ACCT_STAGE_TYPE;
CREATE TABLE DWH_TST_DB.L_LN_ACCT_STAGE_TYPE(
	STAGE_TYPE_ID		INT,
	STAGE_TYPE_COD		INT,
	STAGE_TYPE_DESC_EN	String,
	STAGE_TYPE_DESC_AR	String,
	BUSINESS_DT			INT
)CLUSTERED BY (STAGE_TYPE_COD) INTO 1 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.L_LN_ACCT_OPEN_BALANCE_AMOUNT;
CREATE TABLE DWH_TST_DB.L_LN_ACCT_OPEN_BALANCE_AMOUNT(
	OPEN_BAL_AMT_ID			INT,
	OPEN_BAL_AMT_COD		INT,
	OPEN_BAL_AMT_DESC_EN		String ,
	OPEN_BAL_AMT_DESC_AR		String ,
	BUSINESS_DT			INT
)CLUSTERED BY (OPEN_BAL_AMT_COD) INTO 1 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.F_LN_SCHEDULE;
CREATE TABLE DWH_TST_DB.F_LN_SCHEDULE(
	LN_SCHEDULE_ID			INT,
	ACCT_ID				INT,
	INT_DUE_AMT			DOUBLE ,
	OS_PRINCIPAL_AMT		DOUBLE ,
	PRINCIPAL_DUE_AMT		DOUBLE ,
	CTR_PAYMENT_NUM			INT,
	DT_DUE				INT,
	Business_DT			INT
)CLUSTERED BY (ACCT_ID) INTO 128 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");



DROP TABLE DWH_TST_DB.B_CBR_DETAILS;
CREATE TABLE DWH_TST_DB.B_CBR_DETAILS(
	CBR_DETAIL_ID				INT,
	CBR_DETAIL_VALUE_ID			INT,
	ACCT_ID					INT,
	DWH_ID					INT,
	SOURCE_MODULE				String ,
	CLASS_COD				String ,
	CLASS_VALUE				String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	ROWHASH					String,
	Business_DT				INT
)CLUSTERED BY (SOURCE_MODULE,CLASS_COD,CLASS_VALUE) INTO 6 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");

DROP TABLE DWH_TST_DB.H_CBR_DETAILS;
CREATE TABLE DWH_TST_DB.H_CBR_DETAILS(
	CBR_DETAIL_ID				INT,
	CBR_DETAIL_VALUE_ID			INT,
	ACCT_ID					INT,
	DWH_ID					INT,
	SOURCE_MODULE				String ,
	CLASS_COD				String ,
	CLASS_VALUE				String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	ROWHASH					String,
	Business_DT				INT
)CLUSTERED BY (SOURCE_MODULE,CLASS_COD,CLASS_VALUE) INTO 6 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

DROP TABLE DWH_TST_DB.L_CBR_DETAILS_VALUES;
CREATE TABLE DWH_TST_DB.L_CBR_DETAILS_VALUES(
	CBR_DETAIL_VALUE_ID			INT,
	CBR_DETAIL_LABELS_ID			INT,
	SOURCE_MODULE				String ,
	FIELD_NAME				String ,
	ATTRIBUTE_VALUE_COD			String ,
	ATTRIBUTE_VALUE_DESC			String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	Business_DT				INT
)CLUSTERED BY (SOURCE_MODULE,CBR_DETAIL_LABELS_ID) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.L_CBR_DETAILS_LABELS;
CREATE TABLE DWH_TST_DB.L_CBR_DETAILS_LABELS(
	CBR_DETAIL_LABELS_ID			INT,
	SOURCE_MODULE				String ,
	FIELD_NAME				String ,
	LABEL					String ,
	DATA_TYPE				String ,
	FLG_MANDATORY				String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	Business_DT				INT
)CLUSTERED BY (SOURCE_MODULE) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.D_THIRD_PARTY;
CREATE TABLE DWH_TST_DB.D_THIRD_PARTY (
	THIRD_PARTY_ID				INT,
	THIRD_PARTY_COD				String ,
	PARTY_TYPE_ID				INT,
	CITY_NAME				String ,
	COUNTRY_NAME				String ,
	STATE_NAME				String ,
	PARTY_NAME				String ,
	ADDR1					String ,
	ADDR2					String ,
	ZIP_COD					String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	LAST_MNT_DT				INT,
	ROWHASH					String,
	BUSINESS_DT				INT
)CLUSTERED BY (THIRD_PARTY_COD,PARTY_TYPE_ID) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('TRANSACTIONAL'='TRUE', "ORC.COMPRESS"="SNAPPY");


DROP TABLE DWH_TST_DB.H_THIRD_PARTY;
CREATE TABLE DWH_TST_DB.H_THIRD_PARTY (
	THIRD_PARTY_ID				INT,
	THIRD_PARTY_COD				String ,
	PARTY_TYPE_ID				INT,
	CITY_NAME				String ,
	COUNTRY_NAME				String ,
	STATE_NAME				String ,
	PARTY_NAME				String ,
	ADDR1					String ,
	ADDR2					String ,
	ZIP_COD					String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	LAST_MNT_DT				INT,
	ROWHASH					String,
	BUSINESS_DT				INT
)CLUSTERED BY (THIRD_PARTY_COD,PARTY_TYPE_ID) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.L_THIRD_PARTY_TYPE;
CREATE TABLE DWH_TST_DB.L_THIRD_PARTY_TYPE(
	PARTY_TYPE_ID				INT,
	PARTY_COD				INT,
	PARTY_DESC_EN				STRING,
	PARTY_DESC_AR				STRING,
	BUSINESS_DT				INT
)
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");



DROP TABLE DWH_TST_DB.F_MARKET_SHARE;
CREATE TABLE DWH_TST_DB.F_MARKET_SHARE(
	MARKET_SHARE_ID					INT,
	TOTAL_MARKET_DT					INT,
	30_ACC						DOUBLE ,
	90_ACC						DOUBLE ,
	120_ACC						DOUBLE ,
	90_AMT						DOUBLE ,
	30_AMT						DOUBLE ,
	120_AMT						DOUBLE ,
	AVG_CREDIT_LIM					DOUBLE ,
	TOT_CREDIT_FACILITIES_PCT			DOUBLE ,
	TOT_OUTSTANDING_BAL_PCT				DOUBLE ,
	TOT_CREDIT_LIM_PCT				DOUBLE ,
	FILE_NAME					String ,
	BUSINESS_DT					INT
)CLUSTERED BY (TOTAL_MARKET_DT) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.D_CUST_ACCT_REL;
CREATE TABLE DWH_TST_DB.D_CUST_ACCT_REL (
	CUST_ACCT_REL_ID		INT,
	ACCT_ID				INT,
	DWH_ID				INT,
	CUST_ACCT_REL			String ,
	BRN_ID				INT,
	PROD_ID				INT,
	MAKER_ID			String ,
	CHECKER_ID			String ,
	ROWHASH				String,
	BUSINESS_DT			INT
)CLUSTERED BY (ACCT_ID,DWH_ID,CUST_ACCT_REL) INTO 4 BUCKETS
STORED AS ORC
TBLPROPERTIES	('TRANSACTIONAL'='TRUE', "ORC.COMPRESS"="SNAPPY");


DROP TABLE DWH_TST_DB.H_CUST_ACCT_REL;
CREATE TABLE DWH_TST_DB.H_CUST_ACCT_REL (
	CUST_ACCT_REL_ID		INT,
	ACCT_ID				INT,
	DWH_ID				INT,
	CUST_ACCT_REL			String ,
	BRN_ID				INT,
	PROD_ID				INT,
	MAKER_ID			String ,
	CHECKER_ID			String ,
	ROWHASH				String,
	BUSINESS_DT			INT
)CLUSTERED BY (ACCT_ID,DWH_ID,CUST_ACCT_REL) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.F_GL_Balance;
CREATE TABLE DWH_TST_DB.F_GL_Balance(
	GL_BAL_ID			INT,
	BRN_ID				INT,
	GL_ID				INT,
	CCY_ID				INT,
	PERIOD_COD			String ,
	DR_MOV				DOUBLE ,
	CR_MOV				DOUBLE ,
	DR_MOV_LCY			DOUBLE ,
	CR_MOV_LCY			DOUBLE ,
	DR_BAL				DOUBLE ,
	CR_BAL				DOUBLE ,
	DR_BAL_LCY			DOUBLE ,
	CR_BAL_LCY			DOUBLE ,
	UNCOLLECTED			DOUBLE ,
	OPEN_DR_BAL			DOUBLE ,
	OPEN_CR_BAL			DOUBLE ,
	OPEN_DR_BAL_LCY			DOUBLE ,
	OPEN_CR_BAL_LCY			DOUBLE ,
	OPEN_DR_MOV			DOUBLE ,
	OPEN_CR_MOV			DOUBLE ,
	OPEN_DR_MOV_LCY			DOUBLE ,
	OPEN_CR_MOV_LCY			DOUBLE ,
	DR_MOV_OLD			DOUBLE ,
	CR_MOV_OLD			DOUBLE ,
	DR_MOV_LCY_OLD			DOUBLE ,
	CR_MOV_LCY_OLD			DOUBLE ,
	HAS_TOV				String ,
	ACY_TODAY_TOVER_DR		DOUBLE ,
	LCY_TODAY_TOVER_DR		DOUBLE ,
	ACY_TODAY_TOVER_CR		DOUBLE ,
	LCY_TODAY_TOVER_CR		DOUBLE ,
	LOAD_DT				INT,
	Business_DT			INT
)PARTITIONED BY (FIN_YEAR String)
CLUSTERED BY (GL_ID,CCY_ID,PERIOD_COD) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.F_GL_TRX;
CREATE TABLE DWH_TST_DB.F_GL_TRX(
	GL_TRX_ID			INT,
	TRANSACTION_SRC_NUM		String,
	DWH_ID				INT,
	EVENT_SR_NUM			INT,
	EVENT				String ,
	BRN_ID				INT,
	GL_ID				INT,
	CCY_ID				INT,
	DRCR_IND			String ,
	TRN_DT				INT,
	VALUE_DT			INT,
	RELATED_ACCT			String ,
	EXCHANGE_RATE			DOUBLE ,
	FINANCIAL_CYCLE			String ,
	FCY_AMT				DOUBLE ,
	LCY_AMT				DOUBLE ,
	AMT_TAG				String ,
	PERIOD_COD			String ,
	TXN_MNEMONIC_COD		INT,
	USER_ID				String ,
	AUTH_ID				String ,
	TYPE				String ,
	CATEGORY			String ,
	TABLE_NAME			String
	
)PARTITIONED BY (BUSINESS_DT	INT)
CLUSTERED BY (GL_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.D_GL_MASTER;
CREATE TABLE DWH_TST_DB.D_GL_MASTER (
	GL_ID					INT,
	GL_COD					String ,
	GL_DESC					String ,
	PARENT_GL				String ,
	FLG_RES_CCY				String ,
	RES_CCY					String ,
	LEAF					String ,
	TYPE					String ,
	CUST					String ,
	CATEGORY_ID				INT,
	HO_RES					String ,
	REVAL					String ,
	PROFIT_ACCT				String ,
	LOSS_ACCT				String ,
	CBANK_LINE_DR				String ,
	CBANK_LINE_CR				String ,
	HO_LINE_DR				String ,
	HO_LINE_CR				String ,
	FIRST_AUTH				String ,
	ULTI_PARENT				String ,
	BLOCK					String ,
	POSTING_RES				String ,
	RECON					String ,
	RECORD_STATUS				String ,
	ONCE_AUTH				String ,
	AUTH_STATUS				String ,
	MOD_NUM					INT,
	FLG_POSITION_AC				String ,
	CCY_POS_GL				String ,
	ACCT_STMT_REQUIRED			String ,
	GEN_STMT_ONLY_ON_MVMT			String ,
	MEDIA					String ,
	AC_STMT_DAY				INT,
	AC_STMT_CYCLE				String ,
	AC_STMT_TYPE				String ,
	ADDR1					String ,
	ADDR2					String ,
	ADDR3					String ,
	ADDR4					String ,
	IS_ACCRUAL				String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	ROWHASH					String,
	BUSINESS_DT				INT
)CLUSTERED BY (GL_ID,GL_COD) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('TRANSACTIONAL'='TRUE', "ORC.COMPRESS"="SNAPPY");


DROP TABLE DWH_TST_DB.H_GL_MASTER;
CREATE TABLE DWH_TST_DB.H_GL_MASTER (
	GL_ID					INT,
	GL_COD					String ,
	GL_DESC					String ,
	PARENT_GL				String ,
	FLG_RES_CCY				String ,
	RES_CCY					String ,
	LEAF					String ,
	TYPE					String ,
	CUST					String ,
	CATEGORY_ID				INT,
	HO_RES					String ,
	REVAL					String ,
	PROFIT_ACCT				String ,
	LOSS_ACCT				String ,
	CBANK_LINE_DR				String ,
	CBANK_LINE_CR				String ,
	HO_LINE_DR				String ,
	HO_LINE_CR				String ,
	FIRST_AUTH				String ,
	ULTI_PARENT				String ,
	BLOCK					String ,
	POSTING_RES				String ,
	RECON					String ,
	RECORD_STATUS				String ,
	ONCE_AUTH				String ,
	AUTH_STATUS				String ,
	MOD_NUM					INT,
	FLG_POSITION_AC				String ,
	CCY_POS_GL				String ,
	ACCT_STMT_REQUIRED			String ,
	GEN_STMT_ONLY_ON_MVMT			String ,
	MEDIA					String ,
	AC_STMT_DAY				INT,
	AC_STMT_CYCLE				String ,
	AC_STMT_TYPE				String ,
	ADDR1					String ,
	ADDR2					String ,
	ADDR3					String ,
	ADDR4					String ,
	IS_ACCRUAL				String ,
	MAKER_ID				String ,
	CHECKER_ID				String ,
	ROWHASH					String,
	BUSINESS_DT				INT
)CLUSTERED BY (GL_COD,PARENT_GL) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.L_GL_CATEGORY;
CREATE TABLE DWH_TST_DB.L_GL_CATEGORY(
	CATEGORY_ID			INT,
	CATEGORY_COD			String ,
	CATEGORY_DESC_EN		String ,
	CATEGORY_DESC_AR		String ,
	Business_DT			INT
)CLUSTERED BY (CATEGORY_COD) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.L_CREDIT_CARD_SCHEME;
CREATE TABLE DWH_TST_DB.L_CREDIT_CARD_SCHEME(
	CREDIT_CARD_SCHEME_ID		INT,
	CC_GUARANTEE_COD		String ,
	THE_NEW_SCHEME			String ,
	SCHEME_NAME			String ,
	BUSINESS_DT			INT
)CLUSTERED BY (CC_GUARANTEE_COD) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");



DROP TABLE DWH_TST_DB.F_CARDS_LIMIT;
CREATE TABLE DWH_TST_DB.F_CARDS_LIMIT(
	CARD_LIM_ID			INT,
	CARD_ID				INT,
	CARD_LIM			DOUBLE ,
	CASH_LIM			DOUBLE ,
	SALE_LIM			DOUBLE ,
	ACCT_LIM			DOUBLE,
	BUSINESS_DT			INT
)CLUSTERED BY (CARD_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.D_CARD_TYPE_LIMITS;
CREATE TABLE DWH_TST_DB.D_CARD_TYPE_LIMITS (
	CARD_TYPE_LIM_ID		INT,
	CARDTYPE_ID			INT,
	CASH_WD_LIM			DOUBLE ,
	TC_LIM				DOUBLE ,
	CASH_TC_LIM			DOUBLE ,
	PURCH_LIM			DOUBLE ,
	CREDIT_LIM			DOUBLE ,
	TXNCODE				String ,
	CASH_WD_COUNT			INT,
	TC_COUNT			INT,
	PURCH_COUNT			INT,
	CARD_LIFE			String ,
	ROWHASH				String,
	Business_DT			INT
)CLUSTERED BY (CARDTYPE_ID) INTO 4 BUCKETS
STORED AS ORC
TBLPROPERTIES	('TRANSACTIONAL'='TRUE', "ORC.COMPRESS"="SNAPPY");


DROP TABLE DWH_TST_DB.H_CARD_TYPE_LIMITS;
CREATE TABLE DWH_TST_DB.H_CARD_TYPE_LIMITS (
	CARD_TYPE_LIM_ID		INT,
	CARDTYPE_ID			INT,
	CASH_WD_LIM			DOUBLE ,
	TC_LIM				DOUBLE ,
	CASH_TC_LIM			DOUBLE ,
	PURCH_LIM			DOUBLE ,
	CREDIT_LIM			DOUBLE ,
	TXNCODE				String ,
	CASH_WD_COUNT			INT,
	TC_COUNT			INT,
	PURCH_COUNT			INT,
	CARD_LIFE			String ,
	ROWHASH				String,
	Business_DT			INT
)CLUSTERED BY (CARDTYPE_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.L_CARD_TYPE;
CREATE TABLE DWH_TST_DB.L_CARD_TYPE(
	CARD_TYPE_ID		INT,
	BIN			String ,
	CARD_TYPE_LIM_ID	INT,
	CARD_TYPE		String ,
	Card_Product		String ,
	Card_Category_ID	INT,
	CARD_SCHEME_ID		String ,
	Business_DT		INT
)CLUSTERED BY (CARD_TYPE,CARD_TYPE_LIM_ID) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.L_SUB_PRODUCT;
CREATE TABLE DWH_TST_DB.L_SUB_PRODUCT(
	SUB_PROD_ID			INT,
	SUB_PROD_COD			String,
	SUB_PROD_DESC_EN		String,
	SUB_PROD_DESC_AR		String,
	Business_DT			INT
)CLUSTERED BY (SUB_PROD_COD) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.B_PRODUCT_GL;
CREATE TABLE DWH_TST_DB.B_PRODUCT_GL(
	GL_ID				INT,
	PROD_ID				INT,
	ACCOUNTING_ROLE			String ,
	ROLE_TYPE			String ,
	STATUS_ID			INT,
	FLG_BS				INT,
	TABLE_NAME			String ,
	ROWHASH				String,
	BUSINESS_DT			INT
)CLUSTERED BY (GL_ID,PROD_ID) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");


DROP TABLE DWH_TST_DB.H_PRODUCT_GL;
CREATE TABLE DWH_TST_DB.H_PRODUCT_GL(
	GL_ID				INT,
	PROD_ID				INT,
	ACCOUNTING_ROLE			String ,
	ROLE_TYPE			String ,
	STATUS_ID			INT,
	FLG_BS				INT,
	TABLE_NAME			String ,
	ROWHASH				String,
	BUSINESS_DT			INT
)CLUSTERED BY (GL_ID,PROD_ID) INTO 2 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


DROP TABLE DWH_TST_DB.B_PROD_INT_INDEX;
CREATE TABLE DWH_TST_DB.B_PROD_INT_INDEX(
	PROD_ID			INT,
	INT_INDX_ID		INT,
	TABLENAME		String ,
	ROWHASH			String,
	BUSINESS_DT		INT
)CLUSTERED BY (PROD_ID,INT_INDX_ID) INTO 2 BUCKETS
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");

DROP TABLE DWH_TST_DB.F_INT_INDEX_RATE;
CREATE TABLE DWH_TST_DB.F_INT_INDEX_RATE(
	INT_INDX_ID		INT,
	COD_INT_INDX		INT,
	INDX_RAT		DOUBLE ,
	INT_INDX_EFF_DT		INT,
	MAKER_ID		String ,
	CHECKER_ID		String ,
	BUSINESS_DT		INT
)CLUSTERED BY (COD_INT_INDX) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");



DROP TABLE DWH_TST_DB.L_CLUBBING;
CREATE TABLE DWH_TST_DB.L_CLUBBING(
	CLUBBING_ID	INT,
	CLUBBING	STRING,
	BUSINESS_DT	INT
)
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");



DROP TABLE DWH_TST_DB.L_INDUSTRIAL_ACTIVITY;
CREATE TABLE DWH_TST_DB.L_INDUSTRIAL_ACTIVITY(

INDUSTRIAL_ACTIVITY_ID		INT,
SUB_PROD_ID			INT,
SUB_CLASSIFICATION_ID 	        INT,
CBR_DETAIL_VALUE_ID	        INT,
ACTIVITY			String,
ACTIVITY_AMEND			String,
INDUSTRIES			String,
SECTOR				String,
BUSINESS_DT			INT

)
STORED AS ORC
TBLPROPERTIES	('transactional'='true', "orc.compress"="SNAPPY");
