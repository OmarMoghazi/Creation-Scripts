DROP TABLE ANALYTICS_TST_DB.F_ARREARS_DAILY;
CREATE TABLE  ANALYTICS_TST_DB.F_ARREARS_DAILY
(
ARREARS_ID INT,
ACCT_ID INT,
DWH_ID INT,
CCY_ID INT,
MODULE_ID INT,
ARREARS_DUE_AMT DOUBLE,
ARREARS_TYPE_ID INT,
REF_BILL_NUM_SRL INT,
ARREARS_CHARGE_COD INT,
INSTAL_NUM_CTR INT,
SEQ_NUM_CTR INT,
ARREARS_DUE_DT INT,
LAST_PAYMENT_DT INT,
REF_BILLNO_DT INT,
DAYS_PAST_DUE INT,
BUSINESS_DT INT
)CLUSTERED BY (ACCT_ID , CCY_ID , MODULE_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

DROP TABLE ANALYTICS_TST_DB.f_ln_acct_schedule_daily;
CREATE TABLE ANALYTICS_TST_DB.f_ln_acct_schedule_daily 
(   
acct_schedule_id INT,   
acct_id INT,  
DWH_ID INT,
ctr_stage_amd_num INT,   
amd_dt INT,   
ctr_stage_num INT,   
opn_bal_amt DOUBLE,   
open_bal_amt_id INT,   
stage_type_id INT,   
instal_lst_ctr INT,   
int_rat DOUBLE,   
instal_amt DOUBLE,   
dt_first_instal INT,   
ctr_instal DOUBLE,   
frq_instal DOUBLE,   
first_int_dt INT,   
int_frq INT,   
int_ctr INT,   
maker_id STRING,   
checker_id STRING,   
last_mnt_dt INT,  
business_dt INT 
)CLUSTERED BY (acct_id) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

DROP TABLE ANALYTICS_TST_DB.L_SEGMENT;
CREATE TABLE ANALYTICS_TST_DB.L_SEGMENT(
ID						INT,
SEGMENT					STRING,
BUSINESS_DT				INT
)CLUSTERED BY (SEGMENT) INTO 1 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

DROP TABLE analytics_tst_db.Topup_Accts;
create table analytics_tst_db.Topup_Accts
(
ACCT_ID_NEW         INT,
ACCT_ID_OLD         INT,
BUSINESS_DT         INT
)CLUSTERED BY (ACCT_ID_NEW , ACCT_ID_OLD) INTO 8 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");


/* DDL for Table L_BUCKET */
DROP TABLE analytics_tst_db.L_BUCKET;
CREATE TABLE analytics_tst_db.L_BUCKET
(
	  Bucket_ID			INT,
	  Bucket			String,
	  Over_Due_Day			String
)
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");



DROP TABLE ANALYTICS_TST_DB.F_T_ALM_ANALYTICS;
CREATE TABLE  ANALYTICS_TST_DB.F_T_ALM_ANALYTICS
(

 ACCT_ID			INT
,DWH_ID				INT
,SUB_PROD_ID			INT
,CONTRACT_REFERENCE		STRING
,COUNTERPARTY			INT
,PARTITION_KEY			STRING
,REPORTING_DATE			INT
,RUN_CURRENCY			STRING
,JOB_ID				INT
,AGGREGATION_ID			INT
,SCENARIO_ID			INT
,CASH_FLOW_APPROACH_CODE	STRING
,VIEW_DATE			INT
,RATE_CODE			STRING
,CONTRACT_TYPE			STRING
,FAMILY				STRING
,BOOK_CODE			STRING
,INSTRUMENT_ATTRIBUTE_1		STRING
,INSTRUMENT_ATTRIBUTE_2		STRING
,INSTRUMENT_ATTRIBUTE_3		STRING
,INSTRUMENT_ATTRIBUTE_4		STRING
,INSTRUMENT_ATTRIBUTE_5		STRING
,INSTRUMENT_ATTRIBUTE_6		STRING
,INSTRUMENT_ATTRIBUTE_7		STRING
,INSTRUMENT_ATTRIBUTE_8		STRING
,INSTRUMENT_ATTRIBUTE_9		STRING
,INSTRUMENT_ATTRIBUTE_10	STRING
,INSTRUMENT_ATTRIBUTE_11	STRING
,INSTRUMENT_ATTRIBUTE_12	STRING
,INSTRUMENT_ATTRIBUTE_13	STRING
,INSTRUMENT_ATTRIBUTE_14	STRING
,INSTRUMENT_ATTRIBUTE_15	STRING
,INSTRUMENT_ATTRIBUTE_16	STRING
,INSTRUMENT_ATTRIBUTE_17	STRING
,INSTRUMENT_ATTRIBUTE_18	STRING
,INSTRUMENT_ATTRIBUTE_19	STRING
,INSTRUMENT_ATTRIBUTE_20	STRING
,INSTRUMENT_AMOUNT_1		DOUBLE
,INSTRUMENT_AMOUNT_2		DOUBLE
,ENTITY_ATTRIBUTE_1		STRING
,ENTITY_ATTRIBUTE_2		STRING
,ENTITY_ATTRIBUTE_3		STRING
,ENTITY_ATTRIBUTE_4		STRING
,ENTITY_ATTRIBUTE_5		STRING
,ENTITY_ATTRIBUTE_6		STRING
,ENTITY_ATTRIBUTE_7		STRING
,ENTITY_ATTRIBUTE_8		STRING
,ENTITY_ATTRIBUTE_9		STRING
,ENTITY_ATTRIBUTE_10		STRING
,ENTITY_ATTRIBUTE_11		STRING
,ENTITY_ATTRIBUTE_12		STRING
,ENTITY_ATTRIBUTE_13		STRING
,ENTITY_ATTRIBUTE_14		STRING
,ENTITY_ATTRIBUTE_15		STRING
,ENTITY_ATTRIBUTE_16		STRING
,ENTITY_ATTRIBUTE_17		STRING
,ENTITY_ATTRIBUTE_18		STRING
,ENTITY_ATTRIBUTE_19		STRING
,ENTITY_AMOUNT_1		DOUBLE
,ENTITY_AMOUNT_2		DOUBLE
,NEW_VOLUME_RESULT		STRING
,RATE_TYPE			STRING	
,TENOR				STRING
,COA_ACCOUNT_NAME		STRING
,EXTERNAL_AGGREGATION_CODE	STRING
,CURVE_NAME			STRING
,TABLE_NAME			STRING
,COUNTERPARTY_INCORP_COUNTRY	STRING
,DEAL_CCY_CODE			STRING
,INSTRUMENT_TYPE		STRING
,RM_COMPONENT			STRING
,RELEASING_ATTRIBUTE		STRING
,LIQ_SUB_TYPE			STRING
,LIQ_SUB_TYPE_UNDERLYING	STRING
,CLIENT_PROPRIETARY		STRING
,PRODUCT_GL_CRITERIA		STRING
,COUNTERPARTY_ENTITY_TYPE	STRING
,COUNTERPARTY_GROUP		STRING
,GUARANTOR_ENTITY_TYPE		STRING
,GUARANTOR_INCORP_COUNTRY	STRING
,GUARANTOR_CODE			STRING
,CLEAN_VALUE			DOUBLE
,ACCRUED_INTERESTS		DOUBLE
,YIELD_TO_MATURITY		DOUBLE
,MACAULAY_DURATION		DOUBLE
,MODIFIED_DURATION		DOUBLE
,CONVEXITY			DOUBLE
,EFFECTIVE_DURATION		DOUBLE
,EFFECTIVE_CONVEXITY		DOUBLE
,NORMALIZED_VALUE		DOUBLE
,WEIGHTED_AVG_LIFE		DOUBLE
,MARKET_VALUE			DOUBLE	
,OPTION_VALUE			DOUBLE
,LEG_CODE			STRING
,NPV				DOUBLE
,COMPARABLE_YIELD		DOUBLE
,IMPLIED_SPREAD			DOUBLE
,DELTA				DOUBLE
,GAMMA				DOUBLE
,DEF_EFFECTIVE_YIELD		DOUBLE
,DEF_BOOK_VALUE			DOUBLE
,DEF_OUTSTANDING_DEFERMENT	DOUBLE
,THETA				DOUBLE
,VEGA				DOUBLE
,RHO				DOUBLE
,IMPLIED_VOLATILITY		DOUBLE
,OUTSTANDING_BALANCE		DOUBLE
,RHO_OF_HOLDING_COST		DOUBLE
,FX_RATE			DOUBLE
,PV01_DEAL_CCY			DOUBLE
,PV01_REPORTING_CCY		DOUBLE
,ONE_YEAR_EL_UNDRAWN		DOUBLE
,LIFETIME_EL_UNDRAWN		DOUBLE
,TRADING			STRING
,COMPANY_CODE			STRING
,BOOKING_COMPANY		STRING
,SUB_ACCOUNT			STRING
,CUSTOM_DIMENSION_1		STRING
,CUSTOM_DIMENSION_2		STRING
,CUSTOM_DIMENSION_3		STRING
,CUSTOM_DIMENSION_4		STRING
,CUSTOM_DIMENSION_5		STRING
,CUSTOM_DIMENSION_6		STRING
,CUSTOM_DIMENSION_7		STRING
,CUSTOM_DIMENSION_8		STRING
,CUSTOM_DIMENSION_9		STRING
,CUSTOM_DIMENSION_10		STRING
,CUSTOM_DIMENSION_11		STRING
,CUSTOM_DIMENSION_12		STRING
,CUSTOM_DIMENSION_13		STRING
,CUSTOM_DIMENSION_14		STRING
,CUSTOM_DIMENSION_15		STRING
,CUSTOM_DIMENSION_16		STRING
,CUSTOM_DIMENSION_17		STRING
,CUSTOM_DIMENSION_18		STRING
,CUSTOM_DIMENSION_19		STRING
,CUSTOM_DIMENSION_20		STRING
,FTP_RISK_CENTER		STRING
,DEAL_PARENT_ID			INT
,EI_NAME			STRING
,STAGE_ALLOCATION		STRING
,PDM_ID				INT
,DECISION_TREE_ID		INT
,LOG_DATE			INT
,LAST_RULE			STRING
,TRUE_OR_FALSE_ACTION		STRING
,EVALUATION_RESULT		STRING
,AUDIT_TRAIL_DATA		STRING
,AMORTIZED_COST			DOUBLE
,FTP_EVE			DOUBLE
,LIFETIME_EL			DOUBLE
,NOTIONAL_BALANCE		DOUBLE
,ONE_YEAR_EL			DOUBLE
,PROTECTED_BALANCE		DOUBLE
,UNPAID_BALANCE			DOUBLE
,ALLOWANCE_DRAWN		DOUBLE
,ALLOWANCE_UNDRAWN		DOUBLE
,ALLOWANCE			DOUBLE
,ADJUSTMENT_STATUS		STRING
,ALLOWANCE_ADJ_TYPE		STRING
,ACCU_WRITE_OFF			DOUBLE
,REMAINING_LIFE			DOUBLE
,TROUBLED_DBT_RESTRUCTURED	STRING
,PERFORMING_STATUS		STRING
,PAST_DUE_BUCKET_ID		INT
,PAST_DUE_BUCKET_SET_ID		INT
,RATING				STRING
,RATING_HIERARCHY		STRING
,RATING_HORIZON			STRING
,ONE_YEAR_PD			DOUBLE
,LIFETIME_PD			DOUBLE
,ANALYSIS_SCENARIO_CODE		STRING
,AGENCY_CODE			STRING
,GROSS_CARRYING_VALUE		DOUBLE
,LIFETIME_NPV			DOUBLE
,LIFETIME_RECOVERY_NPV		DOUBLE
,SIMULATION_DEF_NAME		STRING
,DISCOUNT_UNWIND		DOUBLE
,INTEREST_INCOME		DOUBLE
,AVAILABLE_AMOUNT		DOUBLE
,INTERCO_BOOK_COMP		STRING
,INTERCO_CPTY_COMP		STRING
,EFFECTIVE_INTEREST_RATE	DOUBLE
,TRANSACTIONAL_ACCOUNT		STRING
,TRADE_DATE_SEGMENT		DOUBLE
,TRADE_DATE_SEGMENTATION	STRING
,MATURITY_SEGMENT		DOUBLE
,MATURITY_SEGMENTATION		STRING
,VALUE_DATE_SEGMENT		DOUBLE
,VALUE_DATE_SEGMENTATION	STRING
,IS_PROTECTED			STRING
,IS_OPERATIONAL			STRING
,IS_LCR_ELIGIBLE		STRING
,BIS_ENTITY_TYPE		STRING
,LIQ_PRODUCT_TYPE		STRING
,ELIGIBILITY_LEVEL		STRING
,SUB_ELIGIBILITY_LEVEL		STRING
,CENTRAL_BANK			STRING
,CB_HAIRCUT			DOUBLE
,LCR_HAIRCUT			DOUBLE
,NETTING_ID			STRING
,LIQ_HAIRCUT			DOUBLE
,IS_CORE_DEPOSIT		STRING
,SUB_MARKET_VALUE		DOUBLE
,SECURITY_REFERENCE		STRING
,SUB_TABLE_NAME			STRING
,OPPOSITE_SECURITY_REFERENCE	STRING
,OPPOSITE_CLIENT_PROPRIETARY	STRING
,LIQ_FACILITY_TYPE		STRING
,LDR_ID				INT
,ENCUMBRANCE_TABLE_NAME		STRING
,ENCUMBRANCE_CODE		STRING
,ENCUMBRANCE_BUCKET_END_DATE	INT
,ENCUMBRANCE_DATE_SEGMENTATION	STRING
,PREPAYMENT_DESCRIPTION		STRING
,DELAYED_PAYMENT_DESCRIPTION	STRING
,RELEASING_DESCRIPTION		STRING
,RUNOFF_DESCRIPTION		STRING
,FACILITY_BEHAVIOR_DESCRIPTION	STRING
,ACCOUNTING_DESCRIPTION		STRING
,CREDIT_SPREAD_DESCRIPTION	STRING
,VOLATILITY_DESCRIPTION		STRING
,CREDIT_LOSS_DESCRIPTION	STRING
,CREDIT_LOSS_PD_DESCRIPTION	STRING
,CREDIT_LOSS_LGD_DESCRIPTION	STRING
,CREDIT_LOSS_EAD_DESCRIPTION	STRING
,CREDIT_LOSS_STAGE_ALLOC_DESC	STRING
,EXTERNAL_MODEL_DESCRIPTION	STRING
,HAIRCUT_DESCRIPTION		STRING
,SELLOFF_DESCRIPTION		STRING
,RM_DESCRIPTION			STRING
,VOLATILITY			DOUBLE
,CREDIT_LOSS_ECL_DESCRIPTION	STRING
,IN_THE_MONEY			STRING
,OPPOSITE_SUB_TABLE_NAME	STRING
,CF_INFLOW_RATE			DOUBLE
,CF_OUTFLOW_RATE		DOUBLE
,OUTSTANDING_INFLOW_RATE	DOUBLE
,OUTSTANDING_OUTFLOW_RATE	DOUBLE
,FAIR_VALUE_INFLOW_RATE		DOUBLE
,FAIR_VALUE_OUTFLOW_RATE	DOUBLE
,ASF_FACTOR			DOUBLE
,RSF_FACTOR			DOUBLE
,STANDARD_RW_NEW		DOUBLE
,ASSET_LIABILITY		STRING
,DESK				STRING
,CLEARING_HOUSE_CODE		STRING
,DEPOSIT_BUCKET			STRING
,DOMESTIC_COUNTERPARTY		STRING
,ENCUMBRANCE_DATE_BUCKET	INT
,ENCUMBRANCE_DATE_STATUS	STRING
,FULL_COLLATERALIZATION		STRING
,IS_CENTRAL_BANK_ELIGIBLE	STRING
,IS_DEPOSIT			STRING
,IS_FX_NETTING_ELIGIBLE		STRING
,IS_SIGNIFICANT_CURRENCY	STRING
,IS_SPOT			STRING
,LCR_FORMULA_INFLOW_ID		STRING
,LCR_FORMULA_OUTFLOW_ID		STRING
,LIQ_PERFORMING_STATUS		STRING
,LIQUIDITY_RISK_COUNTRY		STRING
,MAIN_CATEGORY_CONTRACT		STRING
,MARGIN_AGREEMENT		STRING
,MARKET_DEPTH			STRING
,REG_MATURITY_DATE_STATUS	STRING
,NETTING_REFERENCE		STRING
,NOT_CONTINGENT_SOURCE		STRING
,OPEN_MATURITY			STRING
,OPPOSITE_CCY_CODE		STRING
,OPPOSITE_ELIGIBILITY_LEVEL	STRING
,OPPOSITE_IS_LCR_ELIGIBLE	STRING
,OPPOSITE_SUB_LIQ_PRODUCT_TYPE	STRING
,OUT_CONTROL_TREASURER		STRING
,PERIODIC_REALISATION		STRING
,RECEIVED			STRING
,RECOGNIZED_EXCHANGE		STRING
,RISK_BUCKET			STRING
,RISK_BUCKET_ORIGINAL_FINAL	STRING
,RUN_OFF_SME_RETAIL_PREF	STRING
,SECURED			STRING
,SELF_ISSUED			STRING
,SENIORITY			STRING
,STANDARD_RW_ORIGINAL		DOUBLE
,SUB_ATTRIBUTE_1		STRING
,SUB_ATTRIBUTE_2		STRING
,SUB_ATTRIBUTE_3		STRING
,SUB_ATTRIBUTE_4		STRING
,SUB_ATTRIBUTE_5		STRING
,SUB_ATTRIBUTE_6		STRING
,SUB_ATTRIBUTE_7		STRING
,SUB_ATTRIBUTE_8		STRING
,SUB_ATTRIBUTE_9		STRING
,SUB_ATTRIBUTE_10		STRING
,SUB_ATTRIBUTE_11		STRING
,SUB_ATTRIBUTE_12		STRING
,SUB_ATTRIBUTE_13		STRING
,SUB_ATTRIBUTE_14		STRING
,SUB_ATTRIBUTE_15		STRING
,SUB_ATTRIBUTE_16		STRING
,SUB_ATTRIBUTE_17		STRING
,SUB_ATTRIBUTE_18		STRING
,SUB_ATTRIBUTE_19		STRING
,SUB_ATTRIBUTE_20		STRING
,SUB_BIS_ENTITY_CATEGORY	STRING
,SUB_BIS_ENTITY_TYPE		STRING
,SUB_BIS_GUARANTOR_CATEGORY	STRING
,SUB_BIS_GUARANTOR_TYPE		STRING
,SUB_CCY_CODE			STRING
,SUB_ELIGIBILITY_BUCKET_NEW	STRING
,SUB_INCORPORATION_COUNTRY	STRING
,SUB_LIQ_PRODUCT_TYPE		STRING
,SUB_MATURITY_DATE		INT
,SUB_OPPOSITE_ELIGIBILITY_LEVEL	STRING
,SUB_ORIGINAL_MATURITY		DOUBLE
,SUB_RISK_BUCKET		STRING
,SUB_RISK_BUCKET_NEW_FINAL	STRING
,SUB_RISK_BUCKET_ORI_FINAL	STRING
,SUB_STANDARD_RW_NEW		DOUBLE
,SUB_STANDARD_RW_ORIGINAL	DOUBLE
,UND_POOL_REF			STRING
,UND_POOL_ROLE			STRING
,UND_POOL_TYPE			STRING
,REG_VALUE_DATE_STATUS		STRING
,REQ_COLLATERALIZATION_RATIO	DOUBLE
,COMMITTED			STRING
,REVOLVING			STRING
,IS_REVOL_NM_CREFAC_DRAWDOWN	STRING
,FACILITY_LIQ_TYPE		STRING
,MARGIN_DESCRIPTION		STRING
,RENEGOTIATION_DESCRIPTION	STRING
,NPV_INT			DOUBLE
,NII_SNAPSHOT			DOUBLE
,GENERIC_FIELD1			STRING
,GENERIC_FIELD2			STRING
,GENERIC_FIELD3			STRING
,GENERIC_FIELD4			STRING
,GENERIC_FIELD5			STRING
,GENERIC_FIELD6			STRING
,GENERIC_FIELD7			STRING
,GENERIC_FIELD8			STRING
,GENERIC_FIELD9			STRING
,GENERIC_FIELD10		STRING
,GENERIC_NUMBER1		DOUBLE
,GENERIC_NUMBER2		DOUBLE
,GENERIC_NUMBER3		DOUBLE
,GENERIC_NUMBER4		DOUBLE
,GENERIC_NUMBER5		DOUBLE
,GENERIC_NUMBER6		DOUBLE
,GENERIC_NUMBER7		DOUBLE
,GENERIC_NUMBER8		DOUBLE
,GENERIC_NUMBER9		DOUBLE
,GENERIC_NUMBER10		DOUBLE
,CUSTOMER_FIELD1		STRING
,CUSTOMER_FIELD2		STRING
,CUSTOMER_FIELD3		STRING
,CUSTOMER_FIELD4		STRING
,CUSTOMER_FIELD5		STRING
,CUSTOMER_FIELD6		STRING
,CUSTOMER_FIELD7		STRING
,CUSTOMER_FIELD8		STRING
,CUSTOMER_FIELD9		STRING
,CUSTOMER_FIELD10		STRING
,CUSTOMER_NUMBER1		INT
,CUSTOMER_NUMBER2		INT
,CUSTOMER_NUMBER3		INT
,CUSTOMER_NUMBER4		INT
,CUSTOMER_NUMBER5		INT
,CUSTOMER_NUMBER6		INT
,CUSTOMER_NUMBER7		INT
,CUSTOMER_NUMBER8		INT
,CUSTOMER_NUMBER9		INT
,CUSTOMER_NUMBER10		INT
,SRC_REPORTING_DATE		INT
,SRC_WKS_NAME			STRING
,SRC_POSITION			DOUBLE
,GENERIC_REPORTING_DATE		STRING
,GENERIC_WKS_NAME		STRING
,GENERIC_POSITION		STRING
,CONSO_PERIMETER		STRING
,INTERCO			STRING
,INTERCO_TYPE			STRING
,VALID_CPY_PERIMETER		STRING
,FLAG_ADJUSTMENT		STRING
,ID				INT
,PARENT_ID			INT
,CHILD_ID			INT
,ISSUER_ID			INT
,APPROVER_ID			INT
,UPLOAD_DATE			INT
,APPROVAL_DATE			INT
,ADJ_BATCH_DATE			INT
,SOURCE_FILE_NAME		STRING
,ADJ_SEQ			INT
,DP_RULE_LOG			STRING
,IMPORT_SOURCE			STRING
,STAGING_SOURCE			STRING
,CHECK_ERROR_NUMBER		STRING
,CHECK_DATETIME			INT
,CHECK_CONSTRAINTS		STRING
,CHECK_MODE			STRING
,CHECK_ERROR_STATUS		STRING
,CHECK_ERROR_STATUS_G		STRING
,CHECK_ERROR_STATUS_R		STRING
,CHECK_ERROR_STATUS_M		STRING
,CHECK_ERROR_STATUS_A		STRING
,CHECK_ERROR_STATUS_B		STRING
,CHECK_ERROR_STATUS_K		STRING
,CHECK_ERROR_STATUS_S		STRING
,CHECK_ERROR_STATUS_L		STRING
,CHECK_ERROR_STATUS_O		STRING
,CHECK_ERROR_STATUS_T		STRING
,CHECK_ERROR_STATUS_W		STRING
,CHECK_ERROR_STATUS_Y		STRING
,CHECK_ERROR_STATUS_D		STRING
,CHECK_ERROR_STATUS_V		STRING
,CHECK_ERROR_STATUS_X		STRING
,CHECK_ERROR_STATUS_Z		STRING
,CHECK_ERROR_STATUS_F		STRING
,CHECK_ERROR_STATUS_E		STRING
,CREDIT_LOSS_COOLING_OFF_DESC	STRING
,STAGE_ALLOC_BEF_COOLING_OFF	STRING
,NETTING_AGREEMENT		STRING
,ROLLOVER_DESCRIPTION		STRING
,FLG_IS_ACTIVE			INT
,BUSINESS_DT			INT


)CLUSTERED BY (DWH_ID) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");



DROP TABLE DWH_DEV_DB.F_LOANDEPO;
CREATE TABLE DWH_DEV_DB.F_LOANDEPO(

PARTITION_KEY			STRING,
IMPORT_SOURCE			STRING,
CONTRACT_DESC			STRING,
CONTRACT_REFERENCE		STRING,
CONTRACT_TYPE			STRING,
COUNTERPARTY_CODE		STRING,
CURRENCY			STRING,
ATTRIBUTE_1			STRING,
CURVE_NAME			STRING,
DIM11				STRING,
DISCOUNT_CURVE_NAME		STRING,
ATTRIBUTE_2			STRING,
ATTRIBUTE_3			STRING,
ACCRUAL_BASIS			STRING,
ACCRUALS			INT,
AMORTIZING_AMOUNT		DOUBLE,
AMORTIZING_PERIODICITY		STRING,
AMORTIZING_TYPE			STRING,
BOOK_CODE			STRING,
CALC_DAY_CONVENTION		INT,
COMPOUND_PERIODICITY		STRING,
DIM12				STRING,
IMPORT_CF			STRING,
INITIAL_YIELD			DOUBLE,
MATURITY_DATE			INT,
MKT_SPREAD			DOUBLE,
PAST_DUE_DAYS			INT,
PAY_DAY_CONVENTION		INT,
PERFORMING_STATUS		STRING,
PERIODICITY			STRING,
RATE_TYPE			STRING,
RATE_VALUE			DOUBLE,
TENOR				STRING,
TRADE_DATE			INT,
NOMINAL				DOUBLE,
OUTSTANDING			DOUBLE,
VALUE_DATE			INT,
PAST_DUE_INSTALLMENTS		DOUBLE,
ATTRIBUTE_4			STRING,
ATTRIBUTE_5			STRING,
ATTRIBUTE_6			STRING,
ATTRIBUTE_7			STRING,
ATTRIBUTE_8			STRING,
DIM1				STRING,
DIM10				STRING,
DIM2				STRING,
DIM3				STRING,
DIM5				STRING,
NDIM5				DOUBLE,
DIM6				STRING,
DIM7				STRING,
DIM8				STRING,
DIM9				STRING,
NDIM2				DOUBLE,
NDIM3				DOUBLE,
NDIM4				DOUBLE,
RISK_COUNTRY			STRING,
cstins_calc_method		STRING,
CSTINS_CASHFLOW_PRIORITY	STRING,
CSTINS_NEGAM_RULE		STRING,
NDIM1				DOUBLE,
BUSINESS_DT			INT

)CLUSTERED BY (PARTITION_KEY) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");
