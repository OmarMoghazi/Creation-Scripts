DROP TABLE ANALYTICS_TST_DB.f_arrears_daily;
CREATE TABLE  ANALYTICS_TST_DB.f_arrears_daily
(
arrears_id INT,   
acct_id INT,
DWH_ID INT,
ccy_id INT,   
module_id INT,    
Principal_Arrears DOUBLE,
Interest_Arrears DOUBLE,  
Suspended_Penalty_Arrears DOUBLE,  
Suspended_Interest_Arrears DOUBLE,  
Legal_Type_arrear DOUBLE,
Penalty_Arrears DOUBLE,
Fees_Commissions_Arrears DOUBLE,
ref_bill_num_srl INT,
arrears_charge_cod INT,   
instal_num_ctr INT,   
seq_num_ctr INT,   
arrears_due_dt INT,  
last_payment_dt INT,   
ref_billno_dt INT,  
days_past_due INT,
business_dt INT
)CLUSTERED BY (acct_id , ccy_id , module_id) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

DROP TABLE ANALYTICS_TST_DB.f_ln_acct_schedule_daily;
CREATE TABLE ANALYTICS_TST_DB.f_ln_acct_schedule_daily 
(   
acct_schedule_id INT,   
acct_id INT,  
DWH_ID INT,
ctr_stage_amd_num INT,   
amd_dt INT,   
ctr_stage_num INT,   
opn_bal_amt DOUBLE,   
open_bal_amt_id INT,   
stage_type_id INT,   
instal_lst_ctr INT,   
int_rat DOUBLE,   
instal_amt DOUBLE,   
dt_first_instal INT,   
ctr_instal DOUBLE,   
frq_instal DOUBLE,   
first_int_dt INT,   
int_frq INT,   
int_ctr INT,   
maker_id STRING,   
checker_id STRING,   
last_mnt_dt INT,  
business_dt INT 
)CLUSTERED BY (acct_id) INTO 4 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");

DROP TABLE ANALYTICS_TST_DB.L_SEGMENT;
CREATE TABLE ANALYTICS_TST_DB.L_SEGMENT(
ID						INT,
SEGMENT					STRING,
BUSINESS_DT				INT
)CLUSTERED BY (SEGMENT) INTO 1 BUCKETS
STORED AS PARQUET
TBLPROPERTIES	("PARQUET.COMPRESSION"="SNAPPY");
